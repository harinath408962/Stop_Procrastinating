import{r as l,j as e,u as ct,L as ae,S as dt,M as De,a as Ce,U as _e,b as Be,H as mt,C as Ie,c as Te,d as pt,T as We,e as Y,f as ut,Z as de,g as Ae,A as gt,h as Pe,R as le,P as Ue,i as Fe,k as he,l as ce,D as ye,B as xt,m as ht,n as V,p as Ee,q as xe,s as Ke,t as me,v as yt,w as ft,x as jt,y as pe,z as Me,E as He,F as vt,G as Ge,I as St,X as $e,J as bt,K as kt,N as Se,O as be,Y as ke,Q as Le,V as Ne,W as Tt,_ as Oe,$ as wt,a0 as Dt,a1 as Ct,a2 as It,a3 as At,a4 as Ye,a5 as Et,a6 as zt,a7 as Rt,a8 as $,a9 as Lt}from"./vendor-DgLGewnu.js";import{i as Nt,g as Ot,G as _t,a as Bt,d as je,b as Je,s as Ve,o as Wt,w as Pt,c as Ut,e as Ft,f as Kt}from"./firebase-CKJR78QQ.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function s(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(n){if(n.ep)return;n.ep=!0;const a=s(n);fetch(n.href,a)}})();const Mt={apiKey:"AIzaSyCO5r-8hPDpEJD2qY2llWyf_gAQXVlu4CU",authDomain:"stop-procrastinating-9ffaf.firebaseapp.com",projectId:"stop-procrastinating-9ffaf",storageBucket:"stop-procrastinating-9ffaf.firebasestorage.app",messagingSenderId:"270312713724",appId:"1:270312713724:web:98e212793206ff87511679",measurementId:"G-KYLVPZXV20"},qe=Nt(Mt),J=Ot(qe),Ht=new _t,ue=Bt(qe),c={USER_MOOD:"sp_user_mood",TASKS:"sp_tasks",SCHEDULED_TASKS:"sp_scheduled_tasks",DISTRACTION_LOGS:"sp_distraction_logs",WORK_LOGS:"sp_work_logs",REFLECTIONS:"sp_daily_reflections",USER_STATS:"sp_user_stats",EVENT_LOG:"sp_event_log"},Xe=async o=>{if(o)try{const t=je(ue,"users",o.uid),s=await Je(t);if(s.exists()){const r=s.data(),n=a=>{try{return typeof a=="string"?JSON.parse(a):a}catch{return a}};r.tasks&&R(c.TASKS,n(r.tasks),!0),r.scheduled&&R(c.SCHEDULED_TASKS,n(r.scheduled),!0),r.reflections&&R(c.REFLECTIONS,n(r.reflections),!0),r.stats&&R(c.USER_STATS,n(r.stats),!0),r.mood&&R(c.USER_MOOD,r.mood,!0),r.distractions&&R(c.DISTRACTION_LOGS,n(r.distractions),!0),r.work_logs&&R(c.WORK_LOGS,n(r.work_logs),!0),console.log("Full sync from cloud completed."),window.dispatchEvent(new CustomEvent("sp-data-loaded"))}}catch(t){console.error("Error loading from cloud:",t)}},Ze=async(o,t,s=!1)=>{const r=J.currentUser;if(r)try{const n=je(ue,"users",r.uid);s||window.dispatchEvent(new CustomEvent("sp-sync-start"));const i={[c.TASKS]:"tasks",[c.SCHEDULED_TASKS]:"scheduled",[c.REFLECTIONS]:"reflections",[c.USER_STATS]:"stats",[c.USER_MOOD]:"mood",[c.DISTRACTION_LOGS]:"distractions",[c.WORK_LOGS]:"work_logs"}[o];if(i){const m=typeof t=="object"?JSON.stringify(t):t;await Ve(n,{[i]:m},{merge:!0}),console.log(`Synced ${o} to cloud.`),s||window.dispatchEvent(new CustomEvent("sp-sync-success"))}}catch(n){console.error("Cloud sync failed:",n),s||window.dispatchEvent(new CustomEvent("sp-sync-error",{detail:n}))}},g=(o,t=null)=>{try{const s=localStorage.getItem(o);return s?JSON.parse(s):t}catch(s){return console.error(`Error reading ${o} from storage:`,s),t}},R=(o,t,s=!1)=>{try{localStorage.setItem(o,JSON.stringify(t)),s||Ze(o,t)}catch(r){console.error(`Error writing ${o} to storage:`,r)}},Qe=()=>{const o=new Date().toDateString();let t=g(c.USER_STATS,{totalPoints:0,currentStreak:0,longestStreak:0,lastActiveDate:null});if(t.lastActiveDate!==o){const s=new Date;s.setDate(s.getDate()-1),t.lastActiveDate===s.toDateString()?t.currentStreak+=1:t.lastActiveDate===null?t.currentStreak=1:t.currentStreak+=1,t.currentStreak>t.longestStreak&&(t.longestStreak=t.currentStreak),t.lastActiveDate=o,R(c.USER_STATS,t)}return t},we=o=>{let t=g(c.USER_STATS,{totalPoints:0,currentStreak:0,longestStreak:0,lastActiveDate:null});return t.totalPoints+=o,R(c.USER_STATS,t),t},et=()=>{Object.values(c).forEach(o=>{localStorage.removeItem(o)}),localStorage.removeItem("sp_user_name")},Gt=async()=>{if(J.currentUser){window.dispatchEvent(new CustomEvent("sp-sync-start"));try{const t=Object.values(c).map(async s=>{const r=g(s);r!==null&&await Ze(s,r,!0)});return await Promise.all(t),window.dispatchEvent(new CustomEvent("sp-sync-success")),!0}catch(t){return console.error("Force sync failed:",t),window.dispatchEvent(new CustomEvent("sp-sync-error",{detail:t})),!1}}},tt=l.createContext(),rt=()=>l.useContext(tt),$t=({children:o})=>{const[t,s]=l.useState(()=>{try{return localStorage.getItem("sp_theme")||"light"}catch{return"light"}});l.useEffect(()=>{const n=document.documentElement;t==="dark"?n.setAttribute("data-theme","dark"):n.removeAttribute("data-theme"),localStorage.setItem("sp_theme",t)},[t]);const r=()=>{s(n=>n==="light"?"dark":"light")};return e.jsx(tt.Provider,{value:{theme:t,toggleTheme:r},children:o})},F=({children:o})=>{const t=ct(),s=g(c.USER_STATS,{totalPoints:0,currentStreak:0}),[r,n]=l.useState(null),{theme:a,toggleTheme:i}=rt();return l.useEffect(()=>{const m=Wt(J,u=>{n(u)});return()=>m()},[]),e.jsxs("div",{className:"layout-wrapper",style:{minHeight:"100vh",display:"flex",flexDirection:"column"},children:[e.jsxs("header",{style:{padding:"1rem",borderBottom:"1px solid #e2e8f0",display:"flex",justifyContent:"space-between",alignItems:"center",background:"var(--header-bg)",color:"var(--color-text-primary)"},children:[e.jsx(ae,{to:"/",style:{textDecoration:"none",color:"var(--color-primary)",fontWeight:"bold"},children:"Stop Procrastinating"}),e.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center",fontSize:"0.875rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx("span",{role:"img","aria-label":"streak",children:"üî•"}),e.jsxs("span",{children:[s.currentStreak," Days"]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx("span",{role:"img","aria-label":"points",children:"‚ú®"}),e.jsxs("span",{children:[s.totalPoints," pts"]})]}),e.jsx(ae,{to:"/settings",style:{color:"var(--color-primary)",display:"flex",alignItems:"center"},children:e.jsx(dt,{size:20})}),e.jsx("button",{onClick:i,style:{background:"none",border:"none",cursor:"pointer",color:"var(--color-primary)",display:"flex",alignItems:"center",padding:"0.25rem"},"aria-label":"Toggle Theme",children:a==="light"?e.jsx(De,{size:20}):e.jsx(Ce,{size:20})}),r?e.jsx(ae,{to:"/settings",style:{display:"flex",alignItems:"center",gap:"0.5rem",marginLeft:"0.5rem",textDecoration:"none",color:"inherit"},children:r.photoURL?e.jsx("img",{src:r.photoURL,alt:"User",style:{width:"28px",height:"28px",borderRadius:"50%",objectFit:"cover"}}):e.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"50%",background:"rgba(99, 102, 241, 0.1)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--color-primary)"},children:e.jsx(_e,{size:16})})}):e.jsxs(ae,{to:"/signin",style:{display:"flex",alignItems:"center",gap:"0.25rem",textDecoration:"none",color:"var(--color-primary)",marginLeft:"0.5rem"},children:[e.jsx(Be,{size:18}),e.jsx("span",{children:"Sign In"})]})]})]}),e.jsx("main",{style:{flex:1,paddingBottom:"2rem"},children:o}),e.jsxs("nav",{style:{position:"fixed",bottom:0,left:0,width:"100%",background:"var(--nav-bg)",borderTop:"1px solid var(--border-color)",display:"flex",justifyContent:"space-around",padding:"0.75rem 0",zIndex:100},children:[e.jsx(ie,{to:"/",icon:e.jsx(mt,{size:20}),label:"Home",active:t.pathname==="/"||t.pathname==="/mood"}),e.jsx(ie,{to:"/schedule",icon:e.jsx(Ie,{size:20}),label:"Tasks",active:t.pathname==="/schedule"}),e.jsx(ie,{to:"/limit",icon:e.jsx(Te,{size:20}),label:"Limit",active:t.pathname==="/limit"}),e.jsx(ie,{to:"/reflect",icon:e.jsx(pt,{size:20}),label:"Reflect",active:t.pathname==="/reflect"}),e.jsx(ie,{to:"/analysis",icon:e.jsx(We,{size:20}),label:"Analysis",active:t.pathname==="/analysis"})]}),e.jsx("div",{style:{height:"70px"}})]})},ie=({to:o,icon:t,label:s,active:r})=>e.jsxs(ae,{to:o,style:{display:"flex",flexDirection:"column",alignItems:"center",textDecoration:"none",color:r?"var(--color-primary)":"var(--color-text-secondary)",fontSize:"0.75rem"},children:[t,e.jsx("span",{style:{marginTop:"0.25rem"},children:s})]}),Yt=(o,t)=>{const s={morning:{attempts:0,completed:0,totalMinutes:0,score:0},afternoon:{attempts:0,completed:0,totalMinutes:0,score:0},evening:{attempts:0,completed:0,totalMinutes:0,score:0},night:{attempts:0,completed:0,totalMinutes:0,score:0}},r=n=>{const a=new Date(n).getHours();return a>=5&&a<12?"morning":a>=12&&a<17?"afternoon":a>=17&&a<21?"evening":"night"};return o.forEach(n=>{if(!n.completedAt)return;const a=r(n.completedAt);s[a].attempts++,s[a].completed++,s[a].totalMinutes+=parseInt(n.timeTaken)||0}),t.forEach(n=>{const a=r(n.date);s[a].attempts++,s[a].completed++,s[a].totalMinutes+=parseInt(n.duration)||0}),Object.keys(s).forEach(n=>{const a=s[n];a.score=a.totalMinutes+a.completed*10}),s},Jt=o=>{const t={},s={morning:0,afternoon:0,evening:0,night:0};return o.forEach(n=>{t[n.app]=(t[n.app]||0)+1;const a=new Date(n.date).getHours();let i="night";a>=5&&a<12?i="morning":a>=12&&a<17?i="afternoon":a>=17&&a<21&&(i="evening"),s[i]++}),{sortedTriggers:Object.entries(t).sort(([,n],[,a])=>a-n).map(([n,a])=>({app:n,count:a})),timePatterns:s}},st=()=>{const o=g(c.TASKS,[]),t=g(c.SCHEDULED_TASKS,[]),s=g(c.WORK_LOGS,[]),r=g(c.DISTRACTION_LOGS,[]),n=[...o,...t],a=Yt(n,s),{sortedTriggers:i,timePatterns:m}=Jt(r),u=[];let x="morning",T=-1;if(Object.entries(a).forEach(([I,y])=>{y.score>T&&(T=y.score,x=I)}),T>50&&u.push({type:"success",title:"‚ú® Peak Performance",text:`You are naturally most productive in the **${x}**. Schedule your hardest tasks then!`}),i.length>0){const I=i[0];let y="night",w=-1;Object.entries(m).forEach(([A,f])=>{f>w&&(w=f,y=A)}),w>2&&u.push({type:"warning",title:"‚ö†Ô∏è Distraction Alert",text:`Watch out for **${I.app}** in the ${y}. It's your top distraction.`})}return u.length<2&&u.push({type:"info",title:"üí° Tip",text:"Log more work and distractions to unlock deeper insights into your habits."}),u},Vt=()=>{const o=Y(),[t,s]=l.useState("Friend"),[r,n]=l.useState(0),[a,i]=l.useState(0),[m,u]=l.useState("Start your day!"),[x,T]=l.useState(null),[I,y]=l.useState([]),[w,A]=l.useState([]),[f,_]=l.useState(null),[z,M]=l.useState(null);l.useEffect(()=>{const h=C=>{C.preventDefault(),M(C)};return window.addEventListener("beforeinstallprompt",h),()=>window.removeEventListener("beforeinstallprompt",h)},[]);const B=async()=>{if(!z)return;z.prompt();const{outcome:h}=await z.userChoice;h==="accepted"&&M(null)};return l.useEffect(()=>{s(g(c.USER_NAME,"Friend"));const h=g(c.USER_STATS,{currentStreak:0,totalPoints:0});n(h.currentStreak),i(h.totalPoints);const C=()=>{new Date().setHours(0,0,0,0);const j=g(c.DISTRACTION_LOGS,[]).filter(S=>new Date(S.date).toDateString()===new Date().toDateString()),O=j.reduce((S,K)=>S+parseInt(K.duration||0),0),W=j.length,L={};j.forEach(S=>{L[S.app]=(L[S.app]||0)+parseInt(S.duration||0)});const p=Object.entries(L).sort(([,S],[,K])=>K-S).slice(0,3).map(([S,K])=>({name:S,duration:K}));A(p);const v=g(c.TASKS,[]),k=g(c.SCHEDULED_TASKS,[]),P=v.filter(S=>S.completed&&S.completedAt&&new Date(S.completedAt).toDateString()===new Date().toDateString()),q=k.filter(S=>S.completed&&S.completedAt&&new Date(S.completedAt).toDateString()===new Date().toDateString()),te=[...P,...q],Z=te.reduce((S,K)=>S+(parseInt(K.timeTaken)||0),0),re=g(c.WORK_LOGS,[]).filter(S=>new Date(S.date).toDateString()===new Date().toDateString()),se=re.reduce((S,K)=>S+parseInt(K.duration||0),0),Q=Z+se,ne=te.length,N=te.reduce((S,K)=>{if(K.pointsEarned!==void 0)return S+K.pointsEarned;const lt=parseInt(K.timeTaken)||0;return S+10+lt},0),G=re.reduce((S,K)=>S+parseInt(K.duration||0),0),ve=N+G;let d=0,b=0;const E=Q+O;let H="Ready to start?";if(E>0){const S=Math.round(O/E*100);b=S,d=100-S,d>=80?H="You are on fire! üî• Highly Focused.":d>=50?H="Good flow. Keep working! üí™":d>=30?H="Distractions are creeping in. ‚ö†Ô∏è":H="Procrastination is winning. Fight back! üõ°Ô∏è"}u(H);const X=g(c.REFLECTIONS,[]).sort((S,K)=>new Date(K.date)-new Date(S.date))[0],at=X?X.tomorrowGoal:null;_({date:new Date().toISOString(),workScore:d,procrastinationScore:b,tasksDoneCount:ne,pointsScored:ve,distractionTime:O,distractionCount:W,tomorrowGoal:at,workTime:Q,isLive:!0})},D=st();y(D),D&&D.length>0&&T(D[0]),C()},[]),e.jsx(F,{children:e.jsxs("div",{className:"container",style:{textAlign:"center",paddingTop:"2rem"},children:[e.jsx("h1",{style:{fontSize:"2.5rem",marginBottom:"0.5rem",background:"linear-gradient(135deg, #6366f1 0%, #a855f7 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"Stop Procrastinating"}),e.jsx("p",{style:{fontSize:"1.2rem",color:"var(--color-text-secondary)",marginBottom:"2rem"},children:"Start small. Be kind to yourself."}),e.jsxs("div",{className:"card",style:{textAlign:"left",marginBottom:"2rem"},children:[e.jsxs("h3",{style:{margin:"0 0 1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(ut,{className:"text-secondary",size:20}),"Your Progress"]}),e.jsx("div",{style:{marginBottom:"1rem",padding:"0.75rem",background:"var(--color-bg-accent)",borderRadius:"var(--radius-md)",fontWeight:"500",color:"var(--color-primary)"},children:m}),x&&x.type!=="neutral"&&e.jsxs("div",{style:{marginBottom:"1rem",padding:"0.75rem",background:x.type==="warning"?"#fef2f2":x.type==="success"?"#f0fdf4":"#f0f9ff",borderRadius:"var(--radius-md)",border:x.type==="warning"?"1px solid #fecaca":x.type==="success"?"1px solid #bbf7d0":"1px solid #bae6fd",fontSize:"0.9rem",display:"flex",gap:"0.5rem",alignItems:"start"},children:[e.jsx(de,{size:16,style:{marginTop:"2px",color:x.type==="warning"?"#ef4444":x.type==="success"?"#15803d":"#0284c7"}}),e.jsxs("span",{style:{color:x.type==="warning"?"#b91c1c":x.type==="success"?"#166534":"#0369a1"},children:[e.jsxs("strong",{children:[x.title,":"]})," ",x.text.replace(/\*\*/g,"")]})]}),e.jsxs("ul",{style:{paddingLeft:"1.5rem",color:"var(--color-text-secondary)",lineHeight:"1.6",marginBottom:"1rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:r})," Total Days Active"]}),e.jsxs("li",{children:[e.jsx("strong",{children:a})," Focus Points"]})]}),w.length>0&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.9rem",fontWeight:"bold",color:"var(--color-text-primary)",marginBottom:"0.75rem"},children:"Top Distractions Today:"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:w.map((h,C)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",background:"#fff1f2",padding:"0.75rem 1rem",borderRadius:"var(--radius-md)",borderLeft:"4px solid #f43f5e"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(Ae,{size:16,color:"#f43f5e"}),e.jsx("span",{style:{color:"#be123c",fontWeight:"500"},children:h.name})]}),e.jsxs("span",{style:{fontWeight:"bold",color:"#be123c"},children:[h.duration,"m"]})]},C))})]})]}),e.jsx("div",{style:{marginTop:"2rem"},children:e.jsxs("button",{className:"btn-primary",onClick:()=>o("/mood"),children:["Get Started ",e.jsx(gt,{size:18,style:{marginLeft:"0.5rem"}})]})}),f&&e.jsxs("div",{style:{marginTop:"3rem",textAlign:"left"},children:[e.jsxs("h3",{style:{display:"flex",alignItems:"center",gap:"0.5rem",color:"var(--color-text-secondary)"},children:[e.jsx(Pe,{size:18}),"Today's Live Snapshot"]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",justifyContent:"center",gap:"2rem",flexWrap:"wrap"},children:[e.jsxs("div",{style:{width:"160px",height:"160px",position:"relative"},children:[e.jsx(le,{width:"100%",height:"100%",children:e.jsxs(Ue,{children:[e.jsxs(Fe,{data:[{name:"Work",value:f.workScore,color:"#10b981"},{name:"Procrastination",value:f.procrastinationScore,color:"#ef4444"}],dataKey:"value",innerRadius:50,outerRadius:70,startAngle:90,endAngle:-270,paddingAngle:5,children:[e.jsx(he,{fill:"#10b981"},"work"),e.jsx(he,{fill:"#ef4444"},"proc")]}),e.jsx(ce,{})]})}),e.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center"},children:[e.jsxs("div",{style:{fontSize:"1.2rem",fontWeight:"bold",color:f.workScore>=50?"#10b981":"#ef4444"},children:[f.workScore,"%"]}),e.jsx("div",{style:{fontSize:"0.6rem",color:"var(--color-text-secondary)"},children:"Focus"})]})]}),e.jsxs("div",{style:{flex:1,minWidth:"150px"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{style:{textAlign:"center",padding:"0.5rem",background:"#f0fdf4",borderRadius:"8px"},children:[e.jsx("div",{style:{fontSize:"1.1rem",fontWeight:"bold",color:"#15803d"},children:f.tasksDoneCount||0}),e.jsx("div",{style:{fontSize:"0.7rem",color:"#166534"},children:"Tasks Done"})]}),e.jsxs("div",{style:{textAlign:"center",padding:"0.5rem",background:"#fafaebb",borderRadius:"8px",border:"1px solid #fef08a"},children:[e.jsx("div",{style:{fontSize:"1.1rem",fontWeight:"bold",color:"#854d0e"},children:f.pointsScored||0}),e.jsx("div",{style:{fontSize:"0.7rem",color:"#854d0e"},children:"Points"})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"0.85rem",color:"var(--color-text-secondary)"},children:[e.jsx("span",{children:"Worked:"}),e.jsxs("strong",{children:[f.workTime||0,"m"]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"0.85rem",color:"var(--color-text-secondary)",marginTop:"0.25rem"},children:[e.jsx("span",{children:"Distracted:"}),e.jsxs("strong",{children:[f.distractionTime||0,"m"]})]})]})]}),f.tomorrowGoal&&e.jsxs("div",{style:{padding:"0.75rem",background:"var(--color-bg-accent)",borderRadius:"var(--radius-md)",marginTop:"1rem"},children:[e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--color-text-secondary)",display:"flex",alignItems:"center",gap:"0.25rem",marginBottom:"0.25rem"},children:[e.jsx(Ie,{size:12}),new Date(f.date).toDateString()===new Date().toDateString()?"Goal for Tomorrow":"Target"]}),e.jsx("div",{style:{fontWeight:500,fontSize:"0.9rem"},children:f.tomorrowGoal})]})]})]}),z&&e.jsx("div",{style:{marginTop:"2rem"},children:e.jsxs("button",{onClick:B,style:{background:"var(--color-text-primary)",color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"2rem",display:"flex",alignItems:"center",gap:"0.5rem",margin:"0 auto",cursor:"pointer"},children:[e.jsx(ye,{size:18})," Install App"]})})]})})},qt=(o,t={})=>{const s=new Date;let r="night";if(t.overrideTimeOfDay)r=t.overrideTimeOfDay;else{const m=s.getHours();m>=5&&m<12?r="morning":m>=12&&m<17?r="afternoon":m>=17&&m<21&&(r="evening")}const{overrideTimeOfDay:n,...a}=t,i=g(c.USER_MOOD,"neutral");return{event_id:crypto.randomUUID(),user_id:J.currentUser?J.currentUser.uid:"local_user",timestamp:s.toISOString(),date:s.toISOString().split("T")[0],time_of_day:r,event_type:o,mood_before:i,payload:a,synced:!1}},oe=(o,t)=>{const s=qt(o,t),r=g(c.EVENT_LOG,[]);r.push(s),R(c.EVENT_LOG,r),Xt()},Xt=async()=>{const o=J.currentUser;if(!o)return;const t=g(c.EVENT_LOG,[]),s=t.filter(r=>!r.synced);if(s.length!==0)try{const r=Pt(ue),n=Ut(ue,"users",o.uid,"events");s.forEach(i=>{const m=je(n,i.event_id),{synced:u,...x}=i;r.set(m,x)}),await r.commit();const a=t.map(i=>s.find(m=>m.event_id===i.event_id)?{...i,synced:!0}:i);R(c.EVENT_LOG,a),console.log(`Synced ${s.length} events to cloud.`)}catch(r){console.error("Failed to sync events:",r)}},Zt=()=>{const o=Y(),t=[{id:"focused",label:"Focused",icon:e.jsx(de,{size:32}),color:"var(--color-success)",desc:"I'm ready to tackle something big."},{id:"low-energy",label:"Low Energy",icon:e.jsx(xt,{size:32}),color:"var(--color-warning)",desc:"I need something small and easy."},{id:"bored",label:"Bored",icon:e.jsx(ht,{size:32}),color:"var(--color-text-accent)",desc:"I need to get interested."}],s=r=>{R(c.USER_MOOD,r),oe("mood_update",{mood:r}),o("/tasks")};return e.jsx(F,{children:e.jsxs("div",{className:"container",children:[e.jsx("h2",{style:{textAlign:"center",marginBottom:"1rem"},children:"How are you feeling right now?"}),e.jsx("div",{style:{display:"grid",gap:"1rem"},children:t.map(r=>e.jsxs("button",{onClick:()=>s(r.id),className:"card",style:{display:"flex",alignItems:"center",gap:"1rem",textAlign:"left",width:"100%",border:"1px solid transparent",cursor:"pointer",transition:"transform 0.2s, border-color 0.2s"},onMouseEnter:n=>{n.currentTarget.style.transform="scale(1.02)",n.currentTarget.style.borderColor=r.color},onMouseLeave:n=>{n.currentTarget.style.transform="scale(1)",n.currentTarget.style.borderColor="transparent"},children:[e.jsx("div",{style:{color:r.color},children:r.icon}),e.jsxs("div",{children:[e.jsx("strong",{style:{display:"block",fontSize:"1.1rem"},children:r.label}),e.jsx("span",{style:{fontSize:"0.9rem",color:"var(--color-text-secondary)"},children:r.desc})]})]},r.id))})]})})},Qt=()=>{const o=Y(),[t,s]=l.useState([]),[r,n]=l.useState(null),[a,i]=l.useState([]),m=u=>{if(window.confirm("Are you sure you want to delete this task?")){const x=t.filter(y=>y.id!==u);s(x);const I=g(c.TASKS,[]).filter(y=>y.id!==u);R(c.TASKS,I)}};return l.useEffect(()=>{const u=g(c.USER_MOOD);n(u);const T=g(c.TASKS,[]).filter(A=>{var f;return!A.completed&&(((f=A.moods)==null?void 0:f.includes(u))||!A.moods||A.moods.length===0)});s(T);const I=g(c.SCHEDULED_TASKS,[]),y=new Date().setHours(0,0,0,0),w=I.filter(A=>{const f=new Date(A.startDate).setHours(0,0,0,0),_=new Date(A.dueDate).setHours(0,0,0,0);return!A.completed&&y>=f&&y<=_});i(w)},[]),e.jsx(F,{children:e.jsxs("div",{className:"container",children:[e.jsxs("button",{onClick:()=>o("/schedule"),style:{background:"transparent",border:"none",color:"var(--color-primary)",display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0",fontSize:"1rem",cursor:"pointer",marginBottom:"1rem"},children:[e.jsx(V,{size:20})," Back"]}),a.length>0&&e.jsxs("div",{style:{background:"var(--color-bg-accent)",padding:"1rem",borderRadius:"var(--radius-md)",marginBottom:"1.5rem",border:"1px solid var(--color-primary)"},children:[e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"start",color:"var(--color-primary)",marginBottom:"0.5rem"},children:[e.jsx(Ee,{size:20,style:{marginTop:"0.1rem"}}),e.jsxs("strong",{style:{display:"block"},children:["Daily Commitments (",a.length,")"]})]}),a.map(u=>e.jsx("div",{style:{marginLeft:"1.75rem",marginBottom:"0.5rem",borderBottom:"1px solid #e2e8f0",paddingBottom:"0.5rem"},children:e.jsxs("span",{style:{color:"var(--color-text-primary)"},children:["Planned to work on ",e.jsx("strong",{children:u.workToComplete})," for the ",e.jsx("strong",{children:u.name}),"."]})},u.id))]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[e.jsx("h2",{children:"Suggested for You"}),e.jsxs("button",{className:"btn-primary",style:{padding:"0.5rem 1rem",display:"flex",alignItems:"center",gap:"0.5rem"},onClick:()=>o("/add-task"),children:[e.jsx(xe,{size:18})," Add Task"]})]}),t.length===0?e.jsxs("div",{style:{textAlign:"center",color:"var(--color-text-secondary)",padding:"2rem"},children:[e.jsxs("p",{children:["No tasks fit your current mood (",r,")."]}),e.jsx("p",{children:"Why not add a small one?"})]}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:t.map(u=>e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start"},children:e.jsxs("div",{children:[e.jsx("h3",{style:{margin:"0 0 0.25rem",fontSize:"1.25rem"},children:u.title}),e.jsxs("p",{style:{fontSize:"0.9rem",marginBottom:"0.5rem"},children:[e.jsx("strong",{children:"Start with:"})," ",u.smallStep]}),e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.85rem",color:"var(--color-text-secondary)"},children:u.time&&e.jsxs(e.Fragment,{children:[e.jsx(Ke,{size:16})," ",u.time]})})]})}),e.jsxs("div",{style:{marginTop:"1rem",textAlign:"right"},children:[e.jsx("button",{className:"btn-primary",style:{background:"var(--color-success)",fontSize:"0.9rem"},onClick:()=>o(`/complete/${u.id}`),children:"Task Done (Add Proof)"}),e.jsx("button",{style:{background:"transparent",border:"none",color:"#ef4444",marginLeft:"1rem",cursor:"pointer",padding:"0.5rem"},onClick:()=>m(u.id),"aria-label":"Delete task",children:e.jsx(me,{size:18})})]})]},u.id))})]})})},er=()=>{const o=Y(),[t,s]=l.useState({title:"",smallStep:"",moods:[]}),r=[{id:"focused",label:"Focused"},{id:"low-energy",label:"Low Energy"},{id:"bored",label:"Bored"}],n=i=>{i.preventDefault();const m=g(c.TASKS,[]),u={id:Date.now().toString(),...t,completed:!1,createdAt:new Date().toISOString()};R(c.TASKS,[u,...m]),oe("task_create",{task_id:u.id,title:u.title}),o("/tasks")},a=i=>{s(m=>{const u=m.moods.includes(i)?m.moods.filter(x=>x!==i):[...m.moods,i];return{...m,moods:u}})};return e.jsx(F,{children:e.jsxs("div",{className:"container",children:[e.jsxs("button",{onClick:()=>o("/schedule"),style:{background:"transparent",border:"none",color:"var(--color-primary)",display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0",fontSize:"1rem",cursor:"pointer",marginBottom:"1rem"},children:[e.jsx(V,{size:20})," Back"]}),e.jsx("h2",{children:"Add a New Task"}),e.jsxs("form",{onSubmit:n,className:"card",children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{children:"Task Name"}),e.jsx("input",{required:!0,value:t.title,onChange:i=>s({...t,title:i.target.value}),placeholder:"e.g. Study Math"})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{children:"Small First Step (Crucial!)"}),e.jsx("input",{required:!0,value:t.smallStep,onChange:i=>s({...t,smallStep:i.target.value}),placeholder:"e.g. Open the textbook to page 50"}),e.jsx("small",{style:{color:"var(--color-text-secondary)"},children:"Just write what you will do in the first 2 minutes."})]}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("label",{children:"Best for Mood (Optional)"}),e.jsx("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:r.map(i=>e.jsx("button",{type:"button",onClick:()=>a(i.id),style:{padding:"0.5rem 1rem",borderRadius:"var(--radius-full)",border:"1px solid var(--color-primary)",background:t.moods.includes(i.id)?"var(--color-primary)":"transparent",color:t.moods.includes(i.id)?"white":"var(--color-primary)",fontSize:"0.85rem"},children:i.label},i.id))})]}),e.jsx("button",{type:"submit",className:"btn-primary",style:{width:"100%"},children:"Save Task"})]})]})})},ze=({value:o,onChange:t})=>e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",marginTop:"0.5rem"},children:[["15","30","45","60"].map(s=>e.jsxs("button",{type:"button",onClick:()=>t(s),style:{padding:"0.5rem 1rem",borderRadius:"2rem",border:"1px solid var(--color-primary)",background:o===s?"var(--color-primary)":"transparent",color:o===s?"white":"var(--color-primary)",cursor:"pointer",transition:"all 0.2s"},children:[s,"m"]},s)),e.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",placeholder:"Custom (max 600)",value:o,onChange:s=>{const r=s.target.value;(r===""||/^\d+$/.test(r)&&parseInt(r,10)<=600)&&t(r)},style:{width:"120px",padding:"0.5rem",borderRadius:"var(--radius-md)",border:"1px solid #cbd5e1",outlineColor:"var(--color-primary)"}})]}),fe=({value:o,onChange:t,compact:s=!1})=>{const r=[{id:"morning",label:"Morning",icon:e.jsx(Ce,{size:20}),color:"#f59e0b"},{id:"afternoon",label:"Afternoon",icon:e.jsx(yt,{size:20}),color:"#ea580c"},{id:"evening",label:"Evening",icon:e.jsx(ft,{size:20}),color:"#7c3aed"},{id:"night",label:"Night",icon:e.jsx(De,{size:20}),color:"#1e293b"}];return e.jsxs("div",{style:{marginBottom:s?0:"1.5rem"},children:[!s&&e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"var(--color-text-secondary)"},children:"When did this happen?"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:s?"repeat(4, auto)":"repeat(4, 1fr)",gap:s?"0.25rem":"0.5rem"},children:r.map(n=>e.jsxs("button",{type:"button",onClick:()=>t(n.id),title:s?n.label:"",style:{display:"flex",flexDirection:s?"row":"column",alignItems:"center",justifyContent:"center",gap:"0.25rem",padding:s?"0.4rem":"0.75rem 0.25rem",borderRadius:"var(--radius-md)",border:`1px solid ${o===n.id?n.color:"transparent"}`,background:o===n.id?`${n.color}15`:"var(--color-bg-secondary)",color:o===n.id?n.color:"var(--color-text-secondary)",cursor:"pointer",transition:"all 0.2s"},children:[n.icon,!s&&e.jsx("span",{style:{fontSize:"0.75rem",fontWeight:o===n.id?"600":"400"},children:n.label})]},n.id))})]})},tr=()=>{const{taskId:o}=jt(),t=Y(),[s,r]=l.useState(null),[n,a]=l.useState(""),[i,m]=l.useState(""),[u,x]=l.useState(null),T=l.useRef(null),I=l.useRef(null),[y,w]=l.useState(!1),[A,f]=l.useState(0),[_,z]=l.useState("morning");l.useEffect(()=>{const h=new Date().getHours();h>=5&&h<12?z("morning"):h>=12&&h<17?z("afternoon"):h>=17&&h<21?z("evening"):z("night")},[]),l.useEffect(()=>{let C=g(c.TASKS,[]).find(D=>D.id===o);if(!C){const U=g(c.SCHEDULED_TASKS,[]).find(j=>String(j.id)===o);U&&(C={...U,title:U.name,smallStep:U.workToComplete||"Scheduled Work",isSchedule:!0})}C&&r(C)},[o]);const M=h=>{const C=h.target.files[0];if(C){const D=new FileReader;D.onloadend=()=>{x(D.result)},D.readAsDataURL(C)}},B=h=>{h.preventDefault();const C=new Date().setHours(0,0,0,0);let D=10;if(s.isSchedule){const j=new Date(s.dueDate).setHours(0,0,0,0);C<=j?D=100:D=10}const U=parseInt(i)||0;if(D+=U,s.isSchedule){const O=g(c.SCHEDULED_TASKS,[]).map(W=>String(W.id)===o?{...W,completed:!0,completedAt:new Date().toISOString(),timeTaken:parseInt(i)||0,proofImage:u,pointsEarned:D}:W);R(c.SCHEDULED_TASKS,O)}else{const O=g(c.TASKS,[]).map(W=>W.id===o?{...W,completed:!0,learning:n,completedAt:new Date().toISOString(),timeTaken:parseInt(i)||0,proofImage:u,pointsEarned:D}:W);R(c.TASKS,O)}we(D),Qe(),oe("task_complete",{task_id:o,task_title:s.title,actual_time_spent:parseInt(i)||0,points_earned:D,has_proof:!!u,learning_note:n,overrideTimeOfDay:_}),f(D),w(!0)};return s?y?e.jsx(F,{children:e.jsxs("div",{className:"container",style:{textAlign:"center",padding:"3rem 1rem"},children:[e.jsx(pe,{size:64,color:"var(--color-success)",style:{margin:"0 auto 1rem"}}),e.jsx("h2",{children:"Well Done!"}),e.jsx("p",{children:"You started despite resistance. That matters."}),e.jsxs("div",{style:{margin:"2rem 0",padding:"1.5rem",background:"var(--color-bg-accent)",borderRadius:"var(--radius-lg)"},children:[e.jsxs("h3",{style:{margin:0,color:"var(--color-primary)"},children:["+",A," Focus Points"]}),e.jsx("p",{style:{margin:"0.5rem 0 0"},children:"Streak Updated!"})]}),e.jsx("button",{className:"btn-primary",onClick:()=>t("/"),children:"Back Home"})]})}):e.jsx(F,{children:e.jsxs("div",{className:"container",children:[e.jsxs("h2",{children:['Complete "',s.title,'"']}),e.jsx("div",{className:"card",children:e.jsxs("form",{onSubmit:B,children:[e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("label",{children:"Time Taken (minutes)"}),e.jsx(ze,{value:i,onChange:m})]}),e.jsx(fe,{value:_,onChange:z}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("label",{children:"What did you learn or do? (Optional)"}),e.jsx("textarea",{value:n,onChange:h=>a(h.target.value),placeholder:"I learned that starting wasn't so bad...",rows:2})]}),e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem"},children:"Upload Proof (Optional)"}),e.jsx("input",{type:"file",accept:"image/*",ref:T,onChange:M,style:{display:"none"}}),e.jsx("input",{type:"file",accept:"image/*",capture:"environment",id:"cameraInput",ref:I,onChange:M,style:{display:"none"}}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{onClick:()=>{var h;return(h=T.current)==null?void 0:h.click()},style:{border:"2px dashed #cbd5e1",borderRadius:"var(--radius-md)",padding:"1.5rem",textAlign:"center",color:"var(--color-text-secondary)",cursor:"pointer",background:u?"#f0fdf4":"transparent"},children:[e.jsx(Me,{size:24,style:{marginBottom:"0.5rem"}}),e.jsx("div",{children:"Upload Image"})]}),e.jsxs("div",{onClick:()=>{var h;return(h=I.current)==null?void 0:h.click()},style:{border:"2px dashed #cbd5e1",borderRadius:"var(--radius-md)",padding:"1.5rem",textAlign:"center",color:"var(--color-text-secondary)",cursor:"pointer",background:u?"#f0fdf4":"transparent"},children:[e.jsx(He,{size:24,style:{marginBottom:"0.5rem"}}),e.jsx("div",{children:"Take Photo"})]})]}),u&&e.jsx("div",{style:{marginTop:"0.5rem",fontSize:"0.875rem",color:"var(--color-success)",textAlign:"center"},children:"Proof Attached!"})]}),e.jsx("button",{type:"submit",className:"btn-primary",style:{width:"100%",opacity:i?1:.5,cursor:i?"pointer":"not-allowed"},disabled:!i,children:"Mark as Completed"})]})})]})}):e.jsx(F,{children:e.jsx("div",{children:"Loading..."})})},rr=()=>{const o=Y(),[t,s]=l.useState([]),[r,n]=l.useState([]),[a,i]=l.useState(null),[m,u]=l.useState(""),[x,T]=l.useState("morning"),[I,y]=l.useState(!1),[w,A]=l.useState(!1),[f,_]=l.useState(!1),[z,M]=l.useState(""),[B,h]=l.useState(""),[C,D]=l.useState(null),U=l.useRef(null),j=l.useRef(null),[O,W]=l.useState("morning"),[L,p]=l.useState({name:"",workToComplete:"",startDate:"",dueDate:""}),[v,k]=l.useState({title:"",smallStep:"",moods:[]}),[P,q]=l.useState(null),te=[{id:"focused",label:"Focused"},{id:"low-energy",label:"Low Energy"},{id:"bored",label:"Bored"}];l.useEffect(()=>{s(g(c.SCHEDULED_TASKS,[])),n(g(c.TASKS,[]))},[]);const Z=d=>{if(d.preventDefault(),!a||!m)return;const b=parseInt(m);if(isNaN(b)||b<=0)return;const E={id:Date.now().toString(),taskId:a.id,taskTitle:a.title||a.name,duration:b,timeOfDay:x,date:new Date().toISOString()},H=g(c.WORK_LOGS,[]);R(c.WORK_LOGS,[...H,E]),we(b),i(null),u(""),alert(`Logged ${b} mins of work! Keep it up.`)},ge=d=>{if(d.preventDefault(),P){const b=t.map(E=>E.id===P?{...E,...L}:E);R(c.SCHEDULED_TASKS,b),s(b),q(null)}else{const b=[...t,{id:Date.now(),...L}];R(c.SCHEDULED_TASKS,b),s(b)}y(!1),p({name:"",workToComplete:"",startDate:"",dueDate:""})},re=d=>{p({name:d.name,workToComplete:d.workToComplete||"",startDate:d.startDate,dueDate:d.dueDate}),q(d.id),y(!0),A(!1),_(!1)},se=d=>{d.preventDefault();const E=[{id:Date.now().toString(),...v,completed:!1,createdAt:new Date().toISOString()},...r];R(c.TASKS,E),n(E),A(!1),k({title:"",smallStep:"",moods:[]})},Q=d=>{if(window.confirm("Delete this daily task?")){const b=r.filter(E=>E.id!==d);n(b),R(c.TASKS,b)}},ne=d=>{if(window.confirm("Cancel this future plan?")){const b=t.filter(E=>E.id!==d);s(b),R(c.SCHEDULED_TASKS,b)}},N=d=>{k(b=>{const E=b.moods.includes(d)?b.moods.filter(H=>H!==d):[...b.moods,d];return{...b,moods:E}})},G=d=>{const b=d.target.files[0];if(b){const E=new FileReader;E.onloadend=()=>{D(E.result)},E.readAsDataURL(b)}},ve=d=>{d.preventDefault();const E=10+(parseInt(B)||0),H=g(c.TASKS,[]),ee={id:Date.now().toString(),title:z,smallStep:"Ad-hoc Logged",time:B,completed:!0,completedAt:new Date().toISOString(),timeTaken:parseInt(B)||0,proofImage:C,isAdhoc:!0,pointsEarned:E};R(c.TASKS,[ee,...H]),n([ee,...H]),we(E),Qe(),oe("task_complete",{task_id:ee.id,task_title:ee.title,actual_time_spent:parseInt(B)||0,points_earned:E,has_proof:!!C,is_adhoc:!0}),alert(`Saved! +${E} Points.`),_(!1),M(""),h(""),D(null)};return e.jsx(F,{children:e.jsxs("div",{className:"container",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"2rem"},children:[e.jsxs("button",{onClick:()=>o("/"),style:{background:"var(--color-bg-secondary)",border:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",color:"var(--color-primary)",padding:"0.5rem 1rem",borderRadius:"2rem",fontWeight:"500",marginRight:"1rem"},children:[e.jsx(V,{size:18})," Back"]}),e.jsx("h2",{style:{margin:0},children:"Planning Hub"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"3rem"},children:[e.jsxs("div",{className:"card",style:{textAlign:"center",cursor:"pointer",border:w?"2px solid var(--color-primary)":"1px solid transparent",transition:"all 0.2s",padding:"2rem 1rem"},onClick:()=>{A(!w),y(!1),_(!1)},children:[e.jsx("div",{style:{background:"var(--color-bg-accent)",width:"48px",height:"48px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1rem",color:"var(--color-primary)"},children:e.jsx(de,{size:24})}),e.jsx("h3",{style:{fontSize:"1.2rem",margin:"0 0 0.5rem"},children:"Add Task"}),e.jsx("p",{style:{fontSize:"0.9rem",color:"var(--color-text-secondary)",margin:0},children:"For immediate work today. Small steps."})]}),e.jsxs("div",{className:"card",style:{textAlign:"center",cursor:"pointer",border:I?"2px solid var(--color-primary)":"1px solid transparent",padding:"2rem 1rem"},onClick:()=>{y(!I),A(!1),_(!1)},children:[e.jsx("div",{style:{background:"#f0f9ff",width:"48px",height:"48px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1rem",color:"#0284c7"},children:e.jsx(Ie,{size:24})}),e.jsx("h3",{style:{fontSize:"1.2rem",margin:"0 0 0.5rem"},children:"Schedule Future Task"}),e.jsx("p",{style:{fontSize:"0.9rem",color:"var(--color-text-secondary)",margin:0},children:"Plan ahead to reduce uncertainty."})]})]}),w&&e.jsxs("div",{style:{animation:"fadeIn 0.3s ease-in-out"},children:[e.jsx("h3",{style:{marginBottom:"1rem"},children:"Add a New Task"}),e.jsxs("form",{onSubmit:se,className:"card",style:{marginBottom:"3rem",borderLeft:"4px solid var(--color-primary)"},children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{children:"Task Name"}),e.jsx("input",{required:!0,value:v.title,onChange:d=>k({...v,title:d.target.value}),placeholder:"e.g. Study Math",autoFocus:!0})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{children:"Small First Step (Crucial!)"}),e.jsx("input",{required:!0,value:v.smallStep,onChange:d=>k({...v,smallStep:d.target.value}),placeholder:"e.g. Open the textbook to page 50"}),e.jsx("small",{style:{color:"var(--color-text-secondary)"},children:"Just write what you will do in the first 2 minutes."})]}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("label",{children:"Best for Mood (Optional)"}),e.jsx("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:te.map(d=>e.jsx("button",{type:"button",onClick:()=>N(d.id),style:{padding:"0.5rem 1rem",borderRadius:"var(--radius-full)",border:"1px solid var(--color-primary)",background:v.moods.includes(d.id)?"var(--color-primary)":"transparent",color:v.moods.includes(d.id)?"white":"var(--color-primary)",fontSize:"0.85rem"},children:d.label},d.id))})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("button",{type:"button",onClick:()=>A(!1),className:"btn-secondary",style:{flex:1},children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",style:{flex:1},children:"Save Task"})]})]})]}),I&&e.jsxs("div",{style:{animation:"fadeIn 0.3s ease-in-out"},children:[e.jsx("h3",{style:{marginBottom:"1rem"},children:P?"Edit Plan":"New Future Plan"}),e.jsxs("form",{onSubmit:ge,className:"card",style:{marginBottom:"3rem",borderLeft:"4px solid #0284c7"},children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{children:"Task Name"}),e.jsx("input",{required:!0,value:L.name,onChange:d=>p({...L,name:d.target.value}),autoFocus:!0})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{children:"Work to Complete"}),e.jsx("input",{value:L.workToComplete,onChange:d=>p({...L,workToComplete:d.target.value}),placeholder:"e.g. Read Chapters 1-3"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{children:"Start Date"}),e.jsx("input",{type:"date",required:!0,value:L.startDate,onChange:d=>p({...L,startDate:d.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Due Date"}),e.jsx("input",{type:"date",required:!0,value:L.dueDate,onChange:d=>p({...L,dueDate:d.target.value})})]})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("button",{type:"button",onClick:()=>y(!1),className:"btn-secondary",style:{flex:1},children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",style:{flex:1},children:"Save Plan"})]})]})]}),f&&e.jsxs("div",{style:{animation:"fadeIn 0.3s ease-in-out"},children:[e.jsx("h3",{style:{marginBottom:"1rem"},children:"Log Unplanned Work"}),e.jsxs("form",{onSubmit:ve,className:"card",style:{marginBottom:"3rem",borderLeft:"4px solid #8b5cf6"},children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{children:"What did you do?"}),e.jsx("input",{required:!0,value:z,onChange:d=>M(d.target.value),placeholder:"e.g. Helper a friend",autoFocus:!0})]}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("label",{children:"Time Taken (minutes)"}),e.jsx(ze,{value:B,onChange:h})]}),e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem"},children:"Upload Proof (Optional)"}),e.jsx("input",{type:"file",accept:"image/*",ref:U,onChange:G,style:{display:"none"}}),e.jsx("input",{type:"file",accept:"image/*",capture:"environment",ref:j,onChange:G,style:{display:"none"}}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{onClick:()=>{var d;return(d=U.current)==null?void 0:d.click()},style:{border:"2px dashed #cbd5e1",borderRadius:"var(--radius-md)",padding:"1rem",textAlign:"center",cursor:"pointer",background:C?"#f0fdf4":"transparent"},children:[e.jsx(Me,{size:24,style:{marginBottom:"0.5rem"}}),e.jsx("div",{children:"Upload"})]}),e.jsxs("div",{onClick:()=>{var d;return(d=j.current)==null?void 0:d.click()},style:{border:"2px dashed #cbd5e1",borderRadius:"var(--radius-md)",padding:"1rem",textAlign:"center",cursor:"pointer",background:C?"#f0fdf4":"transparent"},children:[e.jsx(He,{size:24,style:{marginBottom:"0.5rem"}}),e.jsx("div",{children:"Camera"})]})]}),C&&e.jsx("div",{style:{marginTop:"0.5rem",fontSize:"0.875rem",color:"var(--color-success)",textAlign:"center"},children:"Proof Attached!"})]}),e.jsx(fe,{value:O,onChange:W}),e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("button",{type:"button",onClick:()=>_(!1),className:"btn-secondary",style:{flex:1},children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",style:{flex:1,opacity:B?1:.5,cursor:B?"pointer":"not-allowed"},disabled:!B,children:"Save Work"})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1.5rem"},children:[e.jsx(vt,{size:20,className:"text-secondary"}),e.jsx("h3",{style:{margin:0,color:"var(--color-text-secondary)"},children:"Your Plans"}),e.jsx("div",{style:{flex:1}}),e.jsx("button",{onClick:()=>{_(!f),A(!1),y(!1)},style:{background:"var(--color-bg-secondary)",border:"none",padding:"0.5rem 1rem",borderRadius:"var(--radius-full)",color:"var(--color-primary)",fontSize:"0.85rem",fontWeight:"500",cursor:"pointer"},children:"+ Log Other Task"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[r.length>0&&r.some(d=>!d.completed)&&e.jsx("h4",{style:{margin:"1rem 0 0.5rem",color:"var(--color-primary)",borderBottom:"1px solid #e2e8f0",paddingBottom:"0.25rem"},children:"Daily Commitments"}),r.filter(d=>!d.completed).map(d=>e.jsxs("div",{className:"card",style:{borderLeft:"4px solid var(--color-warning)"},children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start"},children:e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.25rem"},children:[e.jsx("h3",{style:{margin:0},children:d.title}),e.jsx("span",{style:{fontSize:"0.75rem",background:"#fef3c7",color:"#d97706",padding:"0.1rem 0.4rem",borderRadius:"4px"},children:"Now"})]}),e.jsx("p",{style:{margin:"0 0 0.5rem",color:"var(--color-text-primary)"},children:d.smallStep})]})}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:"1rem",paddingTop:"0.75rem",borderTop:"1px solid #eee",gap:"0.5rem"},children:[e.jsxs("button",{className:"btn-primary",style:{background:"var(--color-success)",fontSize:"0.85rem",padding:"0.5rem 1rem"},onClick:()=>o(`/complete/${d.id}`),children:[e.jsx(pe,{size:16,style:{marginRight:"0.25rem"}})," Task Done"]}),e.jsxs("button",{style:{background:"#fee2e2",border:"none",color:"#ef4444",cursor:"pointer",padding:"0.5rem 1rem",borderRadius:"2rem",fontSize:"0.85rem",display:"flex",alignItems:"center",gap:"0.25rem"},onClick:()=>Q(d.id),children:[e.jsx(me,{size:16})," Delete"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--color-text-secondary)",marginLeft:"auto"},children:d.time&&`${d.time}m`})]})]},d.id)),t.length>0&&e.jsx("h4",{style:{margin:"1.5rem 0 0.5rem",color:"#0284c7",borderBottom:"1px solid #e2e8f0",paddingBottom:"0.25rem"},children:"Future Schedule"}),t.map(d=>{const b=new Date().setHours(0,0,0,0),E=new Date(d.startDate).setHours(0,0,0,0),H=new Date(d.dueDate).setHours(0,0,0,0),ee=b>=E&&b<=H;return H<b||d.completed?null:e.jsxs("div",{className:"card",style:{borderLeft:"4px solid var(--color-primary)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{margin:"0 0 0.25rem"},children:d.name}),e.jsx("p",{style:{margin:"0 0 0.5rem",color:"var(--color-text-primary)"},children:d.workToComplete})]}),ee&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",color:"var(--color-primary)",fontSize:"0.8rem",fontWeight:"bold",background:"var(--color-bg-accent)",padding:"0.25rem 0.5rem",borderRadius:"var(--radius-md)"},children:[e.jsx(Ee,{size:14}),"Active Today"]})]}),e.jsxs("div",{style:{marginTop:"0.5rem",marginBottom:"1rem",fontSize:"0.85rem",color:"var(--color-text-secondary)"},children:[e.jsxs("span",{style:{marginRight:"1rem"},children:["Start: ",d.startDate]}),e.jsxs("span",{children:["Due: ",d.dueDate]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",flexWrap:"wrap",gap:"0.75rem",marginTop:"1rem",paddingTop:"1rem",borderTop:"1px solid #e2e8f0"},children:[e.jsxs("button",{className:"btn-secondary",style:{fontSize:"0.8rem",padding:"0.5rem 1rem",display:"flex",alignItems:"center",gap:"0.25rem"},onClick:()=>i(d),children:[e.jsx(de,{size:14})," Done some work"]}),e.jsxs("button",{className:"btn-primary",style:{background:"var(--color-success)",fontSize:"0.85rem",padding:"0.5rem 1rem",display:"flex",alignItems:"center",gap:"0.25rem"},onClick:()=>o(`/complete/${d.id}`),children:[e.jsx(pe,{size:16})," Task Done"]}),e.jsxs("button",{onClick:()=>re(d),style:{background:"#fef3c7",color:"#d97706",border:"none",cursor:"pointer",padding:"0.5rem 1rem",borderRadius:"2rem",fontSize:"0.8rem",display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(Ge,{size:14})," Edit"]}),e.jsxs("button",{style:{background:"#fee2e2",border:"none",color:"#ef4444",cursor:"pointer",padding:"0.5rem 1rem",borderRadius:"2rem",fontSize:"0.8rem",display:"flex",alignItems:"center",gap:"0.25rem"},onClick:()=>ne(d.id),children:[e.jsx(me,{size:14})," Delete"]})]}),(a==null?void 0:a.id)===d.id&&e.jsxs("div",{style:{marginTop:"1rem",padding:"1rem",background:"var(--color-bg-secondary)",borderRadius:"var(--radius-md)"},children:[e.jsx("h4",{style:{margin:"0 0 0.5rem"},children:"Log Work (Not Done Yet)"}),e.jsxs("form",{onSubmit:Z,style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",placeholder:"Mins",value:m,onChange:Re=>{const X=Re.target.value;(X===""||/^\d+$/.test(X)&&parseInt(X,10)<=600)&&u(X)},style:{width:"80px",padding:"0.5rem",borderRadius:"4px",border:"1px solid #cbd5e1"},autoFocus:!0}),e.jsx(fe,{value:x,onChange:T,compact:!0})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{type:"submit",className:"btn-primary",style:{padding:"0.25rem 0.75rem",fontSize:"0.85rem",flex:1,opacity:m?1:.5},disabled:!m,children:[e.jsx(St,{size:14})," Save"]}),e.jsx("button",{type:"button",onClick:()=>{i(null),u("")},style:{background:"transparent",border:"none",cursor:"pointer",color:"var(--color-text-secondary)"},children:e.jsx($e,{size:18})})]})]})]})]},d.id)}),r.length===0&&t.length===0&&e.jsx("p",{style:{textAlign:"center",padding:"2rem",background:"var(--color-bg-secondary)",borderRadius:"var(--radius-md)"},children:"No plans yet. Clear mind, clear path."})]})]})]})})},sr=()=>{const o=Y(),[t,s]=l.useState(0),[r,n]=l.useState(0),[a,i]=l.useState(""),[m,u]=l.useState([]),[x,T]=l.useState([]),[I,y]=l.useState([]),[w,A]=l.useState(!1),[f,_]=l.useState(0),[z,M]=l.useState(0),[B,h]=l.useState(0),[C,D]=l.useState(0);l.useEffect(()=>{const j=new Date().setHours(0,0,0,0),W=g(c.DISTRACTION_LOGS,[]).filter(N=>new Date(N.date).setHours(0,0,0,0)===j);u(W);const L=W.reduce((N,G)=>N+parseInt(G.duration||0),0);M(L);const p=g(c.TASKS,[]),v=g(c.SCHEDULED_TASKS,[]),k=p.filter(N=>!N.completed||!N.completedAt?!1:new Date(N.completedAt).setHours(0,0,0,0)===j),P=v.filter(N=>!N.completed||!N.completedAt?!1:new Date(N.completedAt).setHours(0,0,0,0)===j),q=[...k,...P];T(q);const Z=g(c.WORK_LOGS,[]).filter(N=>new Date(N.date).setHours(0,0,0,0)===j);y(Z);const ge=q.reduce((N,G)=>N+(parseInt(G.timeTaken)||0),0),re=Z.reduce((N,G)=>N+parseInt(G.duration||0),0),se=ge+re;_(se);const Q=q.length;h(Q),D(Q*10+Z.length*2);const ne=se+L;if(ne>0){const N=Math.round(L/ne*100);s(N),n(100-N)}else n(0),s(0)},[]);const U=j=>{j.preventDefault();const O=g(c.REFLECTIONS,[]),W={id:Date.now(),date:new Date().toISOString(),procrastinationScore:t,workScore:r,tomorrowGoal:a,distractionCount:m.length,distractionTime:z,tasksDoneCount:B,taskTime:f,pointsScored:C};R(c.REFLECTIONS,[W,...O]),oe("diary_entry",{procrastination_score:t,work_score:r,tomorrow_goal:a,total_distraction_time:z,total_work_time:f}),A(!0)};return w?e.jsx(F,{children:e.jsxs("div",{className:"container",style:{textAlign:"center",paddingTop:"3rem"},children:[e.jsx("div",{style:{fontSize:"4rem",marginBottom:"1rem"},children:"üåô"}),e.jsx("h2",{children:"Reflection Saved"}),e.jsx("p",{children:"Rest well. Tomorrow is a fresh start."}),e.jsx("button",{className:"btn-primary",onClick:()=>o("/"),style:{marginTop:"2rem"},children:"Back Home"}),e.jsxs("div",{style:{marginTop:"2rem",padding:"1.5rem",background:"var(--color-bg-accent)",borderRadius:"var(--radius-lg)",textAlign:"left"},children:[e.jsx("h3",{style:{fontSize:"1.1rem",marginTop:0},children:"Target for Tomorrow:"}),e.jsx("p",{style:{fontSize:"1.2rem",color:"var(--color-primary)",fontWeight:600},children:a})]})]})}):e.jsx(F,{children:e.jsxs("div",{className:"container",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"2rem"},children:[e.jsxs("button",{onClick:()=>o("/"),style:{background:"var(--color-bg-secondary)",border:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",color:"var(--color-primary)",padding:"0.5rem 1rem",borderRadius:"2rem",fontWeight:"500",marginRight:"1rem"},children:[e.jsx(V,{size:18})," Back"]}),e.jsx("h2",{style:{margin:0},children:"Today's Reflection"})]}),e.jsxs("form",{onSubmit:U,children:[e.jsxs("div",{className:"card",style:{marginBottom:"1.5rem",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-around",flexWrap:"wrap"},children:[e.jsxs("div",{style:{width:"180px",height:"180px",position:"relative"},children:[e.jsx(le,{width:"100%",height:"100%",children:e.jsxs(Ue,{children:[e.jsxs(Fe,{data:[{name:"Work",value:r,color:"#10b981"},{name:"Procrastination",value:t,color:"#ef4444"}],dataKey:"value",innerRadius:60,outerRadius:80,startAngle:90,endAngle:-270,paddingAngle:5,children:[e.jsx(he,{fill:"#10b981"},"work"),e.jsx(he,{fill:"#ef4444"},"proc")]}),e.jsx(ce,{})]})}),e.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center"},children:[e.jsxs("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:r>=50?"#10b981":"#ef4444"},children:[r,"%"]}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--color-text-secondary)"},children:"Focus"})]})]}),e.jsxs("div",{style:{textAlign:"left",padding:"1rem"},children:[e.jsx("h3",{style:{margin:"0 0 0.5rem",fontSize:"1.2rem"},children:"Day Summary"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.9rem"},children:[e.jsx("div",{style:{width:"12px",height:"12px",borderRadius:"50%",background:"#10b981"}}),e.jsxs("span",{children:["Productive: ",e.jsxs("strong",{children:[f,"m"]})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.9rem"},children:[e.jsx("div",{style:{width:"12px",height:"12px",borderRadius:"50%",background:"#ef4444"}}),e.jsxs("span",{children:["Distracted: ",e.jsxs("strong",{children:[z,"m"]})]})]}),e.jsxs("div",{style:{marginTop:"0.5rem",fontSize:"0.85rem",color:"var(--color-text-secondary)"},children:["Tasks Done: ",e.jsx("strong",{children:B})," | Points: ",e.jsx("strong",{children:C})]})]})]})]}),e.jsxs("div",{className:"card",style:{marginBottom:"2rem"},children:[e.jsxs("h3",{style:{fontSize:"1.1rem",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Pe,{size:18})," Activity Log"]}),x.length===0&&m.length===0&&I.length===0?e.jsx("p",{style:{color:"var(--color-text-secondary)",fontStyle:"italic",textAlign:"center",padding:"1rem"},children:"No activity recorded yet."}):e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[x.map((j,O)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid var(--color-bg-secondary)"},children:[e.jsx("div",{style:{padding:"0.5rem",borderRadius:"50%",background:"#dcfce7",color:"#15803d"},children:e.jsx(pe,{size:16})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:500},children:j.title||j.name}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--color-text-secondary)"},children:"Completed Task"})]}),e.jsxs("div",{style:{fontWeight:"bold",color:"#15803d"},children:[j.timeTaken||0,"m"]})]},`task-${O}`)),I.map((j,O)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid var(--color-bg-secondary)"},children:[e.jsx("div",{style:{padding:"0.5rem",borderRadius:"50%",background:"#dbeafe",color:"#1d4ed8"},children:e.jsx(Ke,{size:16})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:500},children:j.taskTitle}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--color-text-secondary)"},children:"Work Session"})]}),e.jsxs("div",{style:{fontWeight:"bold",color:"#1d4ed8"},children:[j.duration,"m"]})]},`log-${O}`)),m.map((j,O)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid var(--color-bg-secondary)"},children:[e.jsx("div",{style:{padding:"0.5rem",borderRadius:"50%",background:"#fee2e2",color:"#b91c1c"},children:e.jsx(Ae,{size:16})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:500},children:j.app}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--color-text-secondary)"},children:j.reasons.join(", ")})]}),e.jsxs("div",{style:{fontWeight:"bold",color:"#b91c1c"},children:[j.duration,"m"]})]},`dist-${O}`))]})]}),e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx(bt,{size:18})," Goal for Tomorrow"]}),e.jsx("input",{required:!0,value:a,onChange:j=>i(j.target.value),placeholder:"e.g. Finish the Math Chapter without phone",style:{width:"100%",padding:"0.75rem",borderRadius:"var(--radius-md)",border:"1px solid #cbd5e1"}})]}),e.jsx("button",{type:"submit",className:"btn-primary",style:{width:"100%",padding:"1rem"},children:"Save & Close Day"})]})]})})},nr=()=>{const o=Y(),[t,s]=l.useState("initial"),[r,n]=l.useState([]),[a,i]=l.useState(""),[m,u]=l.useState(""),[x,T]=l.useState([]),[I,y]=l.useState(null),[w,A]=l.useState(null),[f,_]=l.useState([]),[z,M]=l.useState(""),[B,h]=l.useState("morning");l.useEffect(()=>{const p=new Date().getHours();p>=5&&p<12?h("morning"):p>=12&&p<17?h("afternoon"):p>=17&&p<21?h("evening"):h("night")},[]),l.useEffect(()=>{const p=g("sp_distraction_types",[]);n(p)},[]);const C=()=>{if(!a)return;let p;I?p=r.map(v=>v.id===I?{...v,name:a,reasons:x.length>0?x:["General"]}:v):p=[...r,{id:Date.now(),name:a,reasons:x.length>0?x:["General"]}],R("sp_distraction_types",p),n(p),i(""),T([]),u(""),y(null),s("initial")},D=p=>{i(p.name),T(p.reasons),y(p.id)},U=p=>{if(window.confirm("Delete this distraction type?")){const v=r.filter(k=>k.id!==p);n(v),R("sp_distraction_types",v),I===p&&(y(null),i(""),T([]))}},j=()=>{m&&(T([...x,m]),u(""))},O=p=>{p.preventDefault();const v=g(c.DISTRACTION_LOGS,[]),k={id:Date.now(),app:w.name,reasons:f,duration:z,date:new Date().toISOString()};R(c.DISTRACTION_LOGS,[k,...v]),oe("distraction_log",{app:w.name,reasons:f,duration:parseInt(z)||0,overrideTimeOfDay:B}),s("success")},W=p=>{f.includes(p)?_(f.filter(v=>v!==p)):_([...f,p])},L=()=>{A(null),_([]),M("")};return t==="calm"?e.jsx(F,{children:e.jsxs("div",{className:"container",style:{textAlign:"center",paddingTop:"4rem"},children:[e.jsx("div",{style:{fontSize:"4rem",marginBottom:"1rem"},children:"üåø"}),e.jsx("h2",{children:"Great Job!"}),e.jsx("p",{children:"Focusing on your improvement is the best gift you can give yourself."}),e.jsx("button",{className:"btn-primary",onClick:()=>s("initial"),style:{marginTop:"2rem"},children:"Back"})]})}):t==="success"?e.jsx(F,{children:e.jsxs("div",{className:"container",style:{textAlign:"center",paddingTop:"4rem"},children:[e.jsx("h2",{children:"Logged."}),e.jsx("p",{children:"Awareness is the first step. Use this data tomorrow."}),e.jsx("button",{className:"btn-primary",onClick:()=>{s("initial"),L()},style:{marginTop:"2rem"},children:"Done"})]})}):t==="config"?e.jsx(F,{children:e.jsxs("div",{className:"container",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h2",{children:I?"Edit Distraction":"Add Distraction"}),e.jsx("button",{onClick:()=>s("initial"),style:{background:"none",border:"none",cursor:"pointer"},children:e.jsx($e,{})})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{children:"Distraction Name"}),e.jsx("input",{value:a,onChange:p=>i(p.target.value),placeholder:"e.g. YouTube Shorts"})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{children:"Possible Reasons"}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx("input",{value:m,onChange:p=>u(p.target.value),placeholder:"e.g. Boredom"}),e.jsx("button",{type:"button",onClick:j,className:"btn-primary",style:{padding:"0.5rem"},children:e.jsx(xe,{size:16})})]}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem"},children:x.map((p,v)=>e.jsx("span",{style:{background:"#f1f5f9",padding:"0.25rem 0.5rem",borderRadius:"4px",fontSize:"0.85rem"},children:p},v))})]}),e.jsx("button",{className:"btn-primary",onClick:C,style:{width:"100%"},children:I?"Update Distraction":"Save Distraction"})]}),e.jsxs("div",{style:{marginTop:"2rem"},children:[e.jsx("h3",{children:"Manage Distractions"}),e.jsxs("div",{style:{display:"grid",gap:"0.5rem"},children:[r.map(p=>e.jsxs("div",{style:{padding:"1rem",background:"var(--color-bg-secondary)",borderRadius:"var(--radius-md)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontWeight:"500"},children:p.name}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{onClick:()=>D(p),style:{background:"none",border:"none",cursor:"pointer",color:"var(--color-primary)"},children:e.jsx(Ge,{size:18})}),e.jsx("button",{onClick:()=>U(p.id),style:{background:"none",border:"none",cursor:"pointer",color:"#ef4444"},children:e.jsx(me,{size:18})})]})]},p.id)),r.length===0&&e.jsx("p",{style:{color:"var(--color-text-secondary)"},children:"No distractions added yet."})]})]})]})}):t==="logging"?e.jsx(F,{children:e.jsxs("div",{className:"container",children:[e.jsxs("button",{onClick:()=>{s("initial"),L()},style:{background:"var(--color-bg-secondary)",border:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",color:"var(--color-primary)",padding:"0.5rem 1rem",borderRadius:"2rem",fontWeight:"500",marginBottom:"1rem"},children:[e.jsx(V,{size:18})," Back"]}),e.jsx("h2",{children:"Log Distraction"}),w?e.jsxs("form",{onSubmit:O,className:"card",children:[e.jsx("h3",{style:{marginTop:0},children:w.name}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("label",{children:"Why did you check it? (Select all that apply)"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",marginTop:"0.5rem"},children:w.reasons.map((p,v)=>e.jsx("button",{type:"button",onClick:()=>W(p),style:{padding:"0.5rem 1rem",borderRadius:"2rem",border:"1px solid var(--color-primary)",background:f.includes(p)?"var(--color-primary)":"white",color:f.includes(p)?"white":"var(--color-primary)",cursor:"pointer"},children:p},v))})]}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("label",{children:"Time Spent (Minutes)"}),e.jsx(ze,{value:z,onChange:M})]}),e.jsx(fe,{value:B,onChange:h}),e.jsx("button",{type:"submit",className:"btn-primary",style:{width:"100%",opacity:z?1:.5,cursor:z?"pointer":"not-allowed"},disabled:!z,children:"Save Log"})]}):e.jsxs("div",{style:{display:"grid",gap:"1.5rem"},children:[e.jsx("p",{style:{textAlign:"center",color:"var(--color-text-secondary)"},children:"What's pulling your attention?"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:"1rem"},children:[r.map(p=>e.jsxs("button",{onClick:()=>A(p),style:{textAlign:"left",cursor:"pointer",border:"1px solid var(--color-bg-secondary)",background:"white",padding:"1.25rem",borderRadius:"var(--radius-lg)",boxShadow:"0 2px 4px rgba(0,0,0,0.05)",transition:"transform 0.1s, border-color 0.1s",display:"flex",alignItems:"center",justifyContent:"space-between"},onMouseEnter:v=>{v.currentTarget.style.borderColor="var(--color-primary)",v.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:v=>{v.currentTarget.style.borderColor="var(--color-bg-secondary)",v.currentTarget.style.transform="translateY(0)"},children:[e.jsx("div",{style:{fontWeight:"600",fontSize:"1.1rem",color:"var(--color-text-primary)"},children:p.name}),e.jsx(V,{size:16,style:{transform:"rotate(180deg)",color:"var(--color-text-secondary)"}})]},p.id)),e.jsxs("button",{onClick:()=>s("config"),style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",cursor:"pointer",border:"2px dashed var(--color-bg-secondary)",background:"transparent",padding:"1rem",borderRadius:"var(--radius-lg)",color:"var(--color-text-secondary)",fontWeight:"500"},children:[e.jsx(xe,{size:20}),e.jsx("span",{children:"Add New"})]})]})]})]})}):e.jsx(F,{children:e.jsxs("div",{className:"container",style:{textAlign:"center",paddingTop:"2rem"},children:[e.jsx("div",{style:{position:"absolute",left:"1rem",top:"5rem"},children:e.jsxs("button",{onClick:()=>o("/"),style:{background:"var(--color-bg-secondary)",border:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",color:"var(--color-primary)",padding:"0.5rem 1rem",borderRadius:"2rem",fontWeight:"500"},children:[e.jsx(V,{size:18})," Back"]})}),e.jsx(Te,{size:64,style:{color:"var(--color-text-accent)",marginBottom:"1rem"}}),e.jsx("h2",{style:{fontSize:"2rem",marginBottom:"2rem"},children:"Distracted?"}),e.jsxs("div",{style:{display:"grid",gap:"1rem",width:"100%",maxWidth:"320px",margin:"0 auto"},children:[e.jsxs("button",{className:"btn-primary",style:{padding:"1.25rem",fontSize:"1.1rem",background:"#fee2e2",color:"#b91c1c",border:"1px solid #fecaca",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.75rem",borderRadius:"var(--radius-lg)"},onClick:()=>{L(),s("logging")},children:[e.jsx(Te,{size:24})," Yes, I gave in"]}),e.jsxs("button",{className:"btn-primary",style:{padding:"1.25rem",fontSize:"1.1rem",background:"#dcfce7",color:"#15803d",border:"1px solid #bbf7d0",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.75rem",borderRadius:"var(--radius-lg)"},onClick:()=>s("calm"),children:[e.jsx(pe,{size:24})," No, I'm focused"]})]}),e.jsx("div",{style:{marginTop:"2rem"},children:e.jsxs("button",{onClick:()=>s("config"),style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",background:"transparent",border:"1px dashed var(--color-text-secondary)",color:"var(--color-text-secondary)",cursor:"pointer",padding:"0.75rem 1.5rem",borderRadius:"var(--radius-full)",fontSize:"0.9rem",transition:"all 0.2s"},children:[e.jsx(xe,{size:16})," Add Distraction"]})})]})})},nt=(o,t="")=>Object.keys(o).reduce((s,r)=>{const n=t.length?t+".":"";return typeof o[r]=="object"&&o[r]!==null&&!Array.isArray(o[r])?Object.assign(s,nt(o[r],n+r)):Array.isArray(o[r])?s[n+r]=o[r].join(";"):s[n+r]=o[r],s},{}),ot=o=>{if(!o||o.length===0)return"";const t=o.map(n=>nt(n)),s=Array.from(new Set(t.flatMap(Object.keys)));return s.sort((n,a)=>n==="timestamp"?-1:a==="timestamp"?1:n==="event_type"?-1:a==="event_type"?1:n.localeCompare(a)),[s.join(","),...t.map(n=>s.map(a=>{let i=n[a]||"";const m=String(i);return m.includes(",")||m.includes('"')||m.includes(`
`)?`"${m.replace(/"/g,'""')}"`:m}).join(","))].join(`
`)},it=(o,t="stop-procrastinating-data.csv")=>{const s=new Blob([o],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a");if(r.download!==void 0){const n=URL.createObjectURL(s);r.setAttribute("href",n),r.setAttribute("download",t),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)}},or=()=>{const o=Y(),[t,s]=l.useState([]),[r,n]=l.useState([]);l.useEffect(()=>{const i=g(c.REFLECTIONS,[]),m={};i.forEach(y=>{const w=new Date(y.date).toDateString();(!m[w]||new Date(y.date)>new Date(m[w].date))&&(m[w]=y)});const x=(()=>{const y=new Date().toDateString(),w=g(c.TASKS,[]),A=g(c.SCHEDULED_TASKS,[]),f=g(c.WORK_LOGS,[]),_=g(c.DISTRACTION_LOGS,[]),z=[...w,...A].filter(k=>k.completed&&k.completedAt&&new Date(k.completedAt).toDateString()===y),M=f.filter(k=>new Date(k.date).toDateString()===y),B=_.filter(k=>new Date(k.date).toDateString()===y),h=z.reduce((k,P)=>k+(parseInt(P.timeTaken)||0),0),C=M.reduce((k,P)=>k+(parseInt(P.duration)||0),0),D=h+C,U=B.reduce((k,P)=>k+(parseInt(P.duration)||0),0),j=z.reduce((k,P)=>P.pointsEarned!==void 0?k+P.pointsEarned:k+10+(parseInt(P.timeTaken)||0),0),O=M.reduce((k,P)=>k+(parseInt(P.duration)||0),0),W=j+O;let L=0,p=0;const v=D+U;return v>0&&(p=Math.round(U/v*100),L=100-p),{date:new Date().toISOString(),workScore:L,procrastinationScore:p,taskTime:D,distractionTime:U,pointsScored:W,isLive:!0}})();if(x.taskTime>0||x.distractionTime>0||x.pointsScored>0){const y=new Date().toDateString();m[y]=x}const T=Object.values(m).sort((y,w)=>new Date(y.date)-new Date(w.date));s(T);const I=st();n(I)},[]);const a=()=>{const i=g(c.EVENT_LOG,[]);if(!i||i.length===0){alert("No detailed event data found yet. Start using the app to generate logs!");return}const m=ot(i);it(m,`stop_procrastinating_events_${new Date().toISOString().split("T")[0]}.csv`)};return e.jsx(F,{children:e.jsxs("div",{className:"container",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"2rem"},children:[e.jsxs("button",{onClick:()=>o("/"),style:{background:"var(--color-bg-secondary)",border:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",color:"var(--color-primary)",padding:"0.5rem 1rem",borderRadius:"2rem",fontWeight:"500",marginRight:"1rem"},children:[e.jsx(V,{size:18})," Back"]}),e.jsx("h2",{style:{flex:1,textAlign:"center",margin:0},children:"Progress Analysis"}),e.jsx("button",{onClick:a,style:{background:"transparent",border:"1px solid var(--color-primary)",color:"var(--color-primary)",padding:"0.5rem",borderRadius:"50%",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},title:"Export Detailed Event Logs (CSV)",children:e.jsx(ye,{size:20})})]}),e.jsxs("div",{style:{display:"grid",gap:"2rem"},children:[r.length>0&&e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"1rem"},children:r.map((i,m)=>e.jsxs("div",{className:"card",style:{background:i.type==="warning"?"#fef2f2":i.type==="success"?"#f0fdf4":"#f0f9ff",border:i.type==="warning"?"1px solid #fecaca":i.type==="success"?"1px solid #bbf7d0":"1px solid #bae6fd"},children:[e.jsxs("h3",{style:{marginBottom:"0.5rem",fontSize:"1rem",color:i.type==="warning"?"#b91c1c":i.type==="success"?"#15803d":"#0369a1",display:"flex",alignItems:"center",gap:"0.5rem"},children:[i.type==="warning"?e.jsx(Ae,{size:18}):i.type==="success"?e.jsx(We,{size:18}):e.jsx(de,{size:18}),i.title]}),e.jsx("p",{style:{color:i.type==="warning"?"#991b1b":i.type==="success"?"#166534":"#0284c7",fontSize:"0.95rem",margin:0},children:i.text.replace(/\*\*/g,"")})]},m))}),e.jsxs("div",{className:"card",style:{height:"400px",display:"flex",flexDirection:"column"},children:[e.jsx("h3",{style:{marginBottom:"1rem",color:"var(--color-text-primary)"},children:"Focus Consistency"}),e.jsx("p",{style:{fontSize:"0.9rem",color:"var(--color-text-secondary)",marginBottom:"1rem"},children:"Work Score vs Procrastination Score over time."}),e.jsx("div",{style:{flex:1,minHeight:0},children:e.jsx(le,{width:"100%",height:"100%",children:e.jsxs(kt,{data:t,margin:{top:5,right:5,bottom:5,left:-20},children:[e.jsx(Se,{strokeDasharray:"3 3",vertical:!1,stroke:"#e2e8f0"}),e.jsx(be,{dataKey:"date",tickFormatter:i=>new Date(i).getDate()+"/"+(new Date(i).getMonth()+1),tick:{fontSize:12},stroke:"#94a3b8"}),e.jsx(ke,{tick:{fontSize:12},stroke:"#94a3b8"}),e.jsx(ce,{labelFormatter:i=>new Date(i).toDateString(),contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)"}}),e.jsx(Le,{}),e.jsx(Ne,{type:"monotone",dataKey:"workScore",name:"Work Score",stroke:"#22c55e",strokeWidth:3,dot:{r:4},activeDot:{r:6}}),e.jsx(Ne,{type:"monotone",dataKey:"procrastinationScore",name:"Procrastination",stroke:"#ef4444",strokeWidth:3,dot:{r:4}})]})})})]}),e.jsxs("div",{className:"card",style:{height:"400px",display:"flex",flexDirection:"column"},children:[e.jsx("h3",{style:{marginBottom:"1rem",color:"var(--color-text-primary)"},children:"Daily Time Breakdown (Mins)"}),e.jsx("div",{style:{flex:1,minHeight:0},children:e.jsx(le,{width:"100%",height:"100%",children:e.jsxs(Tt,{data:t,margin:{top:5,right:5,bottom:5,left:-20},children:[e.jsx(Se,{strokeDasharray:"3 3",vertical:!1,stroke:"#e2e8f0"}),e.jsx(be,{dataKey:"date",tickFormatter:i=>new Date(i).getDate()+"/"+(new Date(i).getMonth()+1),tick:{fontSize:12},stroke:"#94a3b8"}),e.jsx(ke,{tick:{fontSize:12},stroke:"#94a3b8"}),e.jsx(ce,{labelFormatter:i=>new Date(i).toDateString(),cursor:{fill:"#f1f5f9"},contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)"}}),e.jsx(Le,{}),e.jsx(Oe,{dataKey:"taskTime",name:"Productive Time",stackId:"a",fill:"#22c55e",radius:[0,0,4,4]}),e.jsx(Oe,{dataKey:"distractionTime",name:"Distracted Time",stackId:"a",fill:"#f97316",radius:[4,4,0,0]})]})})})]}),e.jsxs("div",{className:"card",style:{height:"350px",display:"flex",flexDirection:"column"},children:[e.jsx("h3",{style:{marginBottom:"1rem",color:"var(--color-text-primary)"},children:"Growth (Points Earned)"}),e.jsx("div",{style:{flex:1,minHeight:0},children:e.jsx(le,{width:"100%",height:"100%",children:e.jsxs(wt,{data:t,margin:{top:5,right:5,bottom:5,left:-20},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorPoints",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#8b5cf6",stopOpacity:.8}),e.jsx("stop",{offset:"95%",stopColor:"#8b5cf6",stopOpacity:0})]})}),e.jsx(Se,{strokeDasharray:"3 3",vertical:!1,stroke:"#e2e8f0"}),e.jsx(be,{dataKey:"date",tickFormatter:i=>new Date(i).getDate()+"/"+(new Date(i).getMonth()+1),tick:{fontSize:12},stroke:"#94a3b8"}),e.jsx(ke,{tick:{fontSize:12},stroke:"#94a3b8"}),e.jsx(ce,{labelFormatter:i=>new Date(i).toDateString(),contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)"}}),e.jsx(Dt,{type:"monotone",dataKey:"pointsScored",name:"Points",stroke:"#8b5cf6",fillOpacity:1,fill:"url(#colorPoints)"})]})})})]})]})]})})},ir=()=>{const o=Y(),[t,s]=l.useState(!1),[r,n]=l.useState(null),a=async()=>{s(!0),n(null);try{const m=(await Ft(J,Ht)).user,u=je(ue,"users",m.uid);if((await Je(u)).exists())et(),await Xe(m);else{const T={email:m.email,displayName:m.displayName,createdAt:new Date().toISOString(),tasks:JSON.stringify(g(c.TASKS,[])),scheduled:JSON.stringify(g(c.SCHEDULED_TASKS,[])),reflections:JSON.stringify(g(c.REFLECTIONS,[])),stats:JSON.stringify(g(c.USER_STATS,{})),mood:g(c.USER_MOOD,null)};await Ve(u,T),console.log("Local data backed up to cloud!")}o("/")}catch(i){console.error("Login Result Error:",i),n(`Failed to sign in: ${i.message}`)}finally{s(!1)}};return e.jsx(F,{children:e.jsx("div",{className:"container",style:{textAlign:"center",marginTop:"4rem"},children:e.jsxs("div",{className:"card",style:{maxWidth:"400px",margin:"0 auto"},children:[e.jsx("h2",{style:{marginBottom:"1rem"},children:"Backup Your Progress"}),e.jsx("p",{style:{color:"var(--color-text-secondary)",marginBottom:"2rem"},children:"Sign in to save your tasks, streaks, and reflections to the cloud. Access them from any device."}),r&&e.jsx("div",{style:{color:"var(--color-danger)",marginBottom:"1rem",fontSize:"0.9rem"},children:r}),e.jsxs("button",{onClick:a,disabled:t,className:"btn-primary",style:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",gap:"0.75rem",padding:"0.75rem"},children:[t?e.jsx(Ct,{className:"spin",size:20}):e.jsx(Be,{size:20}),t?"Signing In...":"Sign in with Google"]})]})})})},ar=()=>{const[o,t]=l.useState("idle");return l.useEffect(()=>{let s;const r=()=>{t("syncing"),clearTimeout(s)},n=()=>{t("success"),s=setTimeout(()=>{t("idle")},3e3)},a=()=>{t("error")};return window.addEventListener("sp-sync-start",r),window.addEventListener("sp-sync-success",n),window.addEventListener("sp-sync-error",a),()=>{window.removeEventListener("sp-sync-start",r),window.removeEventListener("sp-sync-success",n),window.removeEventListener("sp-sync-error",a),clearTimeout(s)}},[]),e.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",padding:"0.25rem 0.75rem",borderRadius:"2rem",fontSize:"0.85rem",fontWeight:"500",transition:"all 0.3s ease",...lr(o)},children:[cr(o),e.jsx("span",{children:dr(o)})]})},lr=o=>{switch(o){case"syncing":return{background:"#ebf8ff",color:"#0369a1"};case"success":return{background:"#f0fdf4",color:"#166534"};case"error":return{background:"#fef2f2",color:"#991b1b"};default:return{}}},cr=o=>{switch(o){case"syncing":return e.jsx(Ye,{size:14,className:"spin"});case"success":return e.jsx(At,{size:14});case"error":return e.jsx(Ee,{size:14});default:return e.jsx(It,{size:14})}},dr=o=>{switch(o){case"syncing":return"Syncing...";case"success":return"Saved";case"error":return"Sync Failed";default:return"Sync Ready"}},mr=()=>{const o=Y(),{theme:t,toggleTheme:s}=rt(),r=J.currentUser,[n,a]=l.useState(0),i=()=>{const T=g(c.EVENT_LOG,[]);if(!T||T.length===0){alert("No data to export yet.");return}const I=ot(T);it(I,`stop_procrastinating_backup_${new Date().toISOString().split("T")[0]}.csv`)},m=()=>{window.confirm("ARE YOU SURE? This will delete ALL your logs, streaks, and local data. This action cannot be undone.")&&(et(),window.location.reload())},u=()=>{Kt(J).then(()=>{o("/"),window.location.reload()})},x=async()=>{await Gt()};return e.jsx(F,{children:e.jsxs("div",{className:"container",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"2rem"},children:[e.jsxs("button",{onClick:()=>o(-1),className:"btn-secondary",style:{display:"flex",alignItems:"center",gap:"0.5rem",marginRight:"1rem"},children:[e.jsx(V,{size:18})," Back"]}),e.jsx("h2",{style:{margin:0},children:"Settings"}),e.jsx("div",{style:{marginLeft:"auto"},children:e.jsx(ar,{})})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[e.jsxs("div",{className:"card",children:[e.jsxs("h3",{style:{marginTop:0,marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[t==="light"?e.jsx(Ce,{size:20}):e.jsx(De,{size:20})," Appearance"]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"App Theme"}),e.jsx("button",{onClick:s,className:"btn-secondary",style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:t==="light"?"Switch to Dark Mode":"Switch to Light Mode"})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("h3",{style:{marginTop:0,marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(ye,{size:20})," Data Management"]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsxs("button",{onClick:x,className:"btn-secondary",style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",width:"100%"},children:[e.jsx(Ye,{size:18})," Sync Now"]}),e.jsxs("button",{onClick:i,className:"btn-secondary",style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",width:"100%"},children:[e.jsx(ye,{size:18})," Export Data (CSV)"]}),e.jsx("div",{style:{borderTop:"1px solid var(--border-color)",margin:"0.5rem 0"}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("strong",{style:{color:"var(--color-danger)"},children:"Danger Zone"}),e.jsx("p",{style:{fontSize:"0.85rem",color:"var(--color-text-secondary)",margin:0},children:"Irreversible data loss."})]}),e.jsxs("button",{onClick:m,style:{background:"#fee2e2",color:"#b91c1c",border:"1px solid #fca5a5",padding:"0.5rem 1rem",borderRadius:"var(--radius-md)",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.9rem",fontWeight:"500"},children:[e.jsx(me,{size:16})," Clear All Data"]})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("h3",{style:{marginTop:0,marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(_e,{size:20})," Account"]}),r?e.jsxs("div",{style:{textAlign:"center"},children:[r.photoURL&&e.jsx("img",{src:r.photoURL,alt:"Profile",style:{width:"64px",height:"64px",borderRadius:"50%",marginBottom:"0.5rem"}}),e.jsx("div",{style:{fontWeight:"bold",fontSize:"1.1rem"},children:r.displayName||"User"}),e.jsx("div",{style:{color:"var(--color-text-secondary)",marginBottom:"1.5rem"},children:r.email}),e.jsxs("button",{onClick:u,className:"btn-secondary",style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem"},children:[e.jsx(Et,{size:18})," Sign Out"]})]}):e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("p",{children:"You are using a local guest account."}),e.jsx("button",{onClick:()=>o("/signin"),className:"btn-primary",style:{width:"100%"},children:"Sign In with Google"})]})]}),e.jsxs("div",{style:{textAlign:"center",color:"var(--color-text-secondary)",fontSize:"0.9rem",marginTop:"1rem",cursor:"default"},onClick:()=>a(T=>T+1),children:[e.jsx("p",{children:"Stop Procrastinating v1.0.2"}),e.jsx("p",{children:"Build healthy habits, one day at a time."}),n>5&&e.jsx("p",{children:"ü¶Ñ You found a unicorn!"})]})]})]})})};function pr(){return l.useEffect(()=>{const o=J.onAuthStateChanged(t=>{t&&Xe(t)});return()=>o()},[]),e.jsx(zt,{children:e.jsxs(Rt,{children:[e.jsx($,{path:"/",element:e.jsx(Vt,{})}),e.jsx($,{path:"/analysis",element:e.jsx(or,{})}),e.jsx($,{path:"/settings",element:e.jsx(mr,{})}),e.jsx($,{path:"/signin",element:e.jsx(ir,{})}),e.jsx($,{path:"/mood",element:e.jsx(Zt,{})}),e.jsx($,{path:"/tasks",element:e.jsx(Qt,{})}),e.jsx($,{path:"/add-task",element:e.jsx(er,{})}),e.jsx($,{path:"/complete/:taskId",element:e.jsx(tr,{})}),e.jsx($,{path:"/schedule",element:e.jsx(rr,{})}),e.jsx($,{path:"/reflect",element:e.jsx(sr,{})}),e.jsx($,{path:"/limit",element:e.jsx(nr,{})})]})})}Lt.createRoot(document.getElementById("root")).render(e.jsx(l.StrictMode,{children:e.jsx($t,{children:e.jsx(pr,{})})}));
