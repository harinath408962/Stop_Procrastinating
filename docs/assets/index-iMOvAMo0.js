import{r as c,j as e,u as dt,L as le,S as mt,M as De,a as Ce,U as Be,b as We,H as pt,C as Ie,c as we,d as ut,T as Pe,e as G,D as ye,f as gt,Z as me,g as Ae,A as xt,h as Ue,R as ce,P as Fe,i as Ke,k as fe,l as de,B as ht,m as yt,n as q,p as Ee,q as he,s as Me,t as pe,v as ft,w as jt,x as vt,y as ue,z as He,E as Ge,F as St,G as $e,I as bt,X as Ye,J as kt,K as wt,N as Se,O as be,Y as ke,Q as Le,V as Ne,W as Tt,_ as Oe,$ as Dt,a0 as Ct,a1 as It,a2 as At,a3 as Et,a4 as qe,a5 as zt,a6 as _e,a7 as Rt,a8 as Lt,a9 as H,aa as Nt}from"./vendor-BxH-JlEu.js";import{i as Ot,g as _t,G as Bt,a as Wt,d as ve,b as Je,s as Ve,o as Pt,w as Ut,c as Ft,e as Kt,f as Mt}from"./firebase-DHWCcEE5.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function s(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(n){if(n.ep)return;n.ep=!0;const a=s(n);fetch(n.href,a)}})();const Ht={apiKey:"AIzaSyCO5r-8hPDpEJD2qY2llWyf_gAQXVlu4CU",authDomain:"stop-procrastinating-9ffaf.firebaseapp.com",projectId:"stop-procrastinating-9ffaf",storageBucket:"stop-procrastinating-9ffaf.firebasestorage.app",messagingSenderId:"270312713724",appId:"1:270312713724:web:98e212793206ff87511679",measurementId:"G-KYLVPZXV20"},Xe=Ot(Ht),$=_t(Xe),Gt=new Bt,ge=Wt(Xe),d={USER_MOOD:"sp_user_mood",TASKS:"sp_tasks",SCHEDULED_TASKS:"sp_scheduled_tasks",DISTRACTION_LOGS:"sp_distraction_logs",WORK_LOGS:"sp_work_logs",REFLECTIONS:"sp_daily_reflections",USER_STATS:"sp_user_stats",EVENT_LOG:"sp_event_log"},Ze=async o=>{if(o)try{const t=ve(ge,"users",o.uid),s=await Je(t);if(s.exists()){const r=s.data(),n=a=>{try{return typeof a=="string"?JSON.parse(a):a}catch{return a}};r.tasks&&R(d.TASKS,n(r.tasks),!0),r.scheduled&&R(d.SCHEDULED_TASKS,n(r.scheduled),!0),r.reflections&&R(d.REFLECTIONS,n(r.reflections),!0),r.stats&&R(d.USER_STATS,n(r.stats),!0),r.mood&&R(d.USER_MOOD,r.mood,!0),r.distractions&&R(d.DISTRACTION_LOGS,n(r.distractions),!0),r.work_logs&&R(d.WORK_LOGS,n(r.work_logs),!0),console.log("Full sync from cloud completed."),window.dispatchEvent(new CustomEvent("sp-data-loaded"))}}catch(t){console.error("Error loading from cloud:",t)}},Qe=async(o,t,s=!1)=>{const r=$.currentUser;if(r)try{const n=ve(ge,"users",r.uid);s||window.dispatchEvent(new CustomEvent("sp-sync-start"));const i={[d.TASKS]:"tasks",[d.SCHEDULED_TASKS]:"scheduled",[d.REFLECTIONS]:"reflections",[d.USER_STATS]:"stats",[d.USER_MOOD]:"mood",[d.DISTRACTION_LOGS]:"distractions",[d.WORK_LOGS]:"work_logs"}[o];if(i){const p=typeof t=="object"?JSON.stringify(t):t;await Ve(n,{[i]:p},{merge:!0}),console.log(`Synced ${o} to cloud.`),s||window.dispatchEvent(new CustomEvent("sp-sync-success"))}}catch(n){console.error("Cloud sync failed:",n),s||window.dispatchEvent(new CustomEvent("sp-sync-error",{detail:n}))}},x=(o,t=null)=>{try{const s=localStorage.getItem(o);return s?JSON.parse(s):t}catch(s){return console.error(`Error reading ${o} from storage:`,s),t}},R=(o,t,s=!1)=>{try{localStorage.setItem(o,JSON.stringify(t)),s||Qe(o,t)}catch(r){console.error(`Error writing ${o} to storage:`,r)}},et=()=>{const o=new Date().toDateString();let t=x(d.USER_STATS,{totalPoints:0,currentStreak:0,longestStreak:0,lastActiveDate:null});if(t.lastActiveDate!==o){const s=new Date;s.setDate(s.getDate()-1),t.lastActiveDate===s.toDateString()?t.currentStreak+=1:t.lastActiveDate===null?t.currentStreak=1:t.currentStreak+=1,t.currentStreak>t.longestStreak&&(t.longestStreak=t.currentStreak),t.lastActiveDate=o,R(d.USER_STATS,t)}return t},Te=o=>{let t=x(d.USER_STATS,{totalPoints:0,currentStreak:0,longestStreak:0,lastActiveDate:null});return t.totalPoints+=o,R(d.USER_STATS,t),t},tt=()=>{Object.values(d).forEach(o=>{localStorage.removeItem(o)}),localStorage.removeItem("sp_user_name")},$t=async()=>{if($.currentUser){window.dispatchEvent(new CustomEvent("sp-sync-start"));try{const t=Object.values(d).map(async s=>{const r=x(s);r!==null&&await Qe(s,r,!0)});return await Promise.all(t),window.dispatchEvent(new CustomEvent("sp-sync-success")),!0}catch(t){return console.error("Force sync failed:",t),window.dispatchEvent(new CustomEvent("sp-sync-error",{detail:t})),!1}}},rt=c.createContext(),st=()=>c.useContext(rt),Yt=({children:o})=>{const[t,s]=c.useState(()=>{try{return localStorage.getItem("sp_theme")||"light"}catch{return"light"}});c.useEffect(()=>{const n=document.documentElement;t==="dark"?n.setAttribute("data-theme","dark"):n.removeAttribute("data-theme"),localStorage.setItem("sp_theme",t)},[t]);const r=()=>{s(n=>n==="light"?"dark":"light")};return e.jsx(rt.Provider,{value:{theme:t,toggleTheme:r},children:o})},W=({children:o})=>{const t=dt(),s=x(d.USER_STATS,{totalPoints:0,currentStreak:0}),[r,n]=c.useState(null),{theme:a,toggleTheme:i}=st();return c.useEffect(()=>{const p=Pt($,u=>{n(u)});return()=>p()},[]),e.jsxs("div",{className:"layout-wrapper",style:{minHeight:"100vh",display:"flex",flexDirection:"column"},children:[e.jsxs("header",{style:{padding:"1rem",borderBottom:"1px solid #e2e8f0",display:"flex",justifyContent:"space-between",alignItems:"center",background:"var(--header-bg)",color:"var(--color-text-primary)"},children:[e.jsx(le,{to:"/",style:{textDecoration:"none",color:"var(--color-primary)",fontWeight:"bold"},children:"Stop Procrastinating"}),e.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center",fontSize:"0.875rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx("span",{role:"img","aria-label":"streak",children:"üî•"}),e.jsxs("span",{children:[s.currentStreak," Days"]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx("span",{role:"img","aria-label":"points",children:"‚ú®"}),e.jsxs("span",{children:[s.totalPoints," pts"]})]}),e.jsx(le,{to:"/settings",style:{color:"var(--color-primary)",display:"flex",alignItems:"center"},children:e.jsx(mt,{size:20})}),e.jsx("button",{onClick:i,style:{background:"none",border:"none",cursor:"pointer",color:"var(--color-primary)",display:"flex",alignItems:"center",padding:"0.25rem"},"aria-label":"Toggle Theme",children:a==="light"?e.jsx(De,{size:20}):e.jsx(Ce,{size:20})}),r?e.jsx(le,{to:"/settings",style:{display:"flex",alignItems:"center",gap:"0.5rem",marginLeft:"0.5rem",textDecoration:"none",color:"inherit"},children:r.photoURL?e.jsx("img",{src:r.photoURL,alt:"User",style:{width:"28px",height:"28px",borderRadius:"50%",objectFit:"cover"}}):e.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"50%",background:"rgba(99, 102, 241, 0.1)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--color-primary)"},children:e.jsx(Be,{size:16})})}):e.jsxs(le,{to:"/signin",style:{display:"flex",alignItems:"center",gap:"0.25rem",textDecoration:"none",color:"var(--color-primary)",marginLeft:"0.5rem"},children:[e.jsx(We,{size:18}),e.jsx("span",{children:"Sign In"})]})]})]}),e.jsx("main",{style:{flex:1,paddingBottom:"2rem"},children:o}),e.jsxs("nav",{style:{position:"fixed",bottom:0,left:0,width:"100%",background:"var(--nav-bg)",borderTop:"1px solid var(--border-color)",display:"flex",justifyContent:"space-around",padding:"0.75rem 0",zIndex:100},children:[e.jsx(ae,{to:"/",icon:e.jsx(pt,{size:20}),label:"Home",active:t.pathname==="/"||t.pathname==="/mood"}),e.jsx(ae,{to:"/schedule",icon:e.jsx(Ie,{size:20}),label:"Tasks",active:t.pathname==="/schedule"}),e.jsx(ae,{to:"/limit",icon:e.jsx(we,{size:20}),label:"Limit",active:t.pathname==="/limit"}),e.jsx(ae,{to:"/reflect",icon:e.jsx(ut,{size:20}),label:"Reflect",active:t.pathname==="/reflect"}),e.jsx(ae,{to:"/analysis",icon:e.jsx(Pe,{size:20}),label:"Analysis",active:t.pathname==="/analysis"})]}),e.jsx("div",{style:{height:"70px"}})]})},ae=({to:o,icon:t,label:s,active:r})=>e.jsxs(le,{to:o,style:{display:"flex",flexDirection:"column",alignItems:"center",textDecoration:"none",color:r?"var(--color-primary)":"var(--color-text-secondary)",fontSize:"0.75rem"},children:[t,e.jsx("span",{style:{marginTop:"0.25rem"},children:s})]}),qt=(o,t)=>{const s={morning:{attempts:0,completed:0,totalMinutes:0,score:0},afternoon:{attempts:0,completed:0,totalMinutes:0,score:0},evening:{attempts:0,completed:0,totalMinutes:0,score:0},night:{attempts:0,completed:0,totalMinutes:0,score:0}},r=n=>{const a=new Date(n).getHours();return a>=5&&a<12?"morning":a>=12&&a<17?"afternoon":a>=17&&a<21?"evening":"night"};return o.forEach(n=>{if(!n.completedAt)return;const a=r(n.completedAt);s[a].attempts++,s[a].completed++,s[a].totalMinutes+=parseInt(n.timeTaken)||0}),t.forEach(n=>{const a=r(n.date);s[a].attempts++,s[a].completed++,s[a].totalMinutes+=parseInt(n.duration)||0}),Object.keys(s).forEach(n=>{const a=s[n];a.score=a.totalMinutes+a.completed*10}),s},Jt=o=>{const t={},s={morning:0,afternoon:0,evening:0,night:0};return o.forEach(n=>{t[n.app]=(t[n.app]||0)+1;const a=new Date(n.date).getHours();let i="night";a>=5&&a<12?i="morning":a>=12&&a<17?i="afternoon":a>=17&&a<21&&(i="evening"),s[i]++}),{sortedTriggers:Object.entries(t).sort(([,n],[,a])=>a-n).map(([n,a])=>({app:n,count:a})),timePatterns:s}},nt=()=>{const o=x(d.TASKS,[]),t=x(d.SCHEDULED_TASKS,[]),s=x(d.WORK_LOGS,[]),r=x(d.DISTRACTION_LOGS,[]),n=[...o,...t],a=qt(n,s),{sortedTriggers:i,timePatterns:p}=Jt(r),u=[];let h="morning",D=-1;if(Object.entries(a).forEach(([v,w])=>{w.score>D&&(D=w.score,h=v)}),D>50&&u.push({type:"success",title:"‚ú® Peak Performance",text:`You are naturally most productive in the **${h}**. Schedule your hardest tasks then!`}),i.length>0){const v=i[0];let w="night",L=-1;Object.entries(p).forEach(([I,m])=>{m>L&&(L=m,w=I)}),L>2&&u.push({type:"warning",title:"‚ö†Ô∏è Distraction Alert",text:`Watch out for **${v.app}** in the ${w}. It's your top distraction.`})}return u.length<2&&u.push({type:"info",title:"üí° Tip",text:"Log more work and distractions to unlock deeper insights into your habits."}),u},Vt=()=>{const o=G(),[t,s]=c.useState("Friend"),[r,n]=c.useState(0),[a,i]=c.useState(0),[p,u]=c.useState("Start your day!"),[h,D]=c.useState(null),[v,w]=c.useState([]),[L,I]=c.useState([]),[m,f]=c.useState(null),[j,U]=c.useState(null);c.useEffect(()=>{const y=E=>{E.preventDefault(),U(E)};return window.addEventListener("beforeinstallprompt",y),()=>window.removeEventListener("beforeinstallprompt",y)},[]);const _=async()=>{if(!j)return;j.prompt();const{outcome:y}=await j.userChoice;y==="accepted"&&U(null)};return c.useEffect(()=>{s(x(d.USER_NAME,"Friend"));const y=x(d.USER_STATS,{currentStreak:0,totalPoints:0});n(y.currentStreak),i(y.totalPoints);const E=()=>{new Date().setHours(0,0,0,0);const b=x(d.DISTRACTION_LOGS,[]).filter(S=>new Date(S.date).toDateString()===new Date().toDateString()),O=b.reduce((S,P)=>S+parseInt(P.duration||0),0),B=b.length,N={};b.forEach(S=>{N[S.app]=(N[S.app]||0)+parseInt(S.duration||0)});const g=Object.entries(N).sort(([,S],[,P])=>P-S).slice(0,3).map(([S,P])=>({name:S,duration:P}));I(g);const T=x(d.TASKS,[]),M=x(d.SCHEDULED_TASKS,[]),X=T.filter(S=>S.completed&&S.completedAt&&new Date(S.completedAt).toDateString()===new Date().toDateString()),Y=M.filter(S=>S.completed&&S.completedAt&&new Date(S.completedAt).toDateString()===new Date().toDateString()),ee=[...X,...Y],J=ee.reduce((S,P)=>S+(parseInt(P.timeTaken)||0),0),te=x(d.WORK_LOGS,[]).filter(S=>new Date(S.date).toDateString()===new Date().toDateString()),re=te.reduce((S,P)=>S+parseInt(P.duration||0),0),se=J+re,oe=ee.length,ie=ee.reduce((S,P)=>{if(P.pointsEarned!==void 0)return S+P.pointsEarned;const ct=parseInt(P.timeTaken)||0;return S+10+ct},0),Z=te.reduce((S,P)=>S+parseInt(P.duration||0),0),C=ie+Z;let l=0,k=0;const A=se+O;let F="Ready to start?";if(A>0){const S=Math.round(O/A*100);k=S,l=100-S,l>=80?F="You are on fire! üî• Highly Focused.":l>=50?F="Good flow. Keep working! üí™":l>=30?F="Distractions are creeping in. ‚ö†Ô∏è":F="Procrastination is winning. Fight back! üõ°Ô∏è"}u(F);const V=x(d.REFLECTIONS,[]).sort((S,P)=>new Date(P.date)-new Date(S.date))[0],lt=V?V.tomorrowGoal:null;f({date:new Date().toISOString(),workScore:l,procrastinationScore:k,tasksDoneCount:oe,pointsScored:C,distractionTime:O,distractionCount:B,tomorrowGoal:lt,workTime:se,isLive:!0})},z=nt();w(z),z&&z.length>0&&D(z[0]),E()},[]),e.jsx(W,{children:e.jsxs("div",{className:"container",style:{textAlign:"center",paddingTop:"2rem"},children:[j&&e.jsx("div",{style:{marginBottom:"1.5rem"},children:e.jsxs("button",{onClick:_,style:{background:"var(--color-primary)",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"2rem",display:"inline-flex",alignItems:"center",gap:"0.5rem",margin:"0 auto",cursor:"pointer",fontSize:"0.9rem",boxShadow:"0 4px 6px -1px rgba(99, 102, 241, 0.3)"},children:[e.jsx(ye,{size:16})," Install App"]})}),e.jsx("h1",{style:{fontSize:"2.5rem",marginBottom:"0.5rem",background:"linear-gradient(135deg, #6366f1 0%, #a855f7 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"Productivity"}),e.jsx("p",{style:{fontSize:"1.2rem",color:"var(--color-text-secondary)",marginBottom:"2rem"},children:"Start small. Be kind to yourself."}),e.jsxs("div",{className:"card",style:{textAlign:"left",marginBottom:"2rem"},children:[e.jsxs("h3",{style:{margin:"0 0 1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(gt,{className:"text-secondary",size:20}),"Your Progress"]}),e.jsx("div",{style:{marginBottom:"1rem",padding:"0.75rem",background:"var(--color-bg-accent)",borderRadius:"var(--radius-md)",fontWeight:"500",color:"var(--color-primary)"},children:p}),h&&h.type!=="neutral"&&e.jsxs("div",{style:{marginBottom:"1rem",padding:"0.75rem",background:h.type==="warning"?"#fef2f2":h.type==="success"?"#f0fdf4":"#f0f9ff",borderRadius:"var(--radius-md)",border:h.type==="warning"?"1px solid #fecaca":h.type==="success"?"1px solid #bbf7d0":"1px solid #bae6fd",fontSize:"0.9rem",display:"flex",gap:"0.5rem",alignItems:"start"},children:[e.jsx(me,{size:16,style:{marginTop:"2px",color:h.type==="warning"?"#ef4444":h.type==="success"?"#15803d":"#0284c7"}}),e.jsxs("span",{style:{color:h.type==="warning"?"#b91c1c":h.type==="success"?"#166534":"#0369a1"},children:[e.jsxs("strong",{children:[h.title,":"]})," ",h.text.replace(/\*\*/g,"")]})]}),e.jsxs("ul",{style:{paddingLeft:"1.5rem",color:"var(--color-text-secondary)",lineHeight:"1.6",marginBottom:"1rem"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:r})," Total Days Active"]}),e.jsxs("li",{children:[e.jsx("strong",{children:a})," Focus Points"]})]}),L.length>0&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.9rem",fontWeight:"bold",color:"var(--color-text-primary)",marginBottom:"0.75rem"},children:"Top Distractions Today:"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:L.map((y,E)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",background:"#fff1f2",padding:"0.75rem 1rem",borderRadius:"var(--radius-md)",borderLeft:"4px solid #f43f5e"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(Ae,{size:16,color:"#f43f5e"}),e.jsx("span",{style:{color:"#be123c",fontWeight:"500"},children:y.name})]}),e.jsxs("span",{style:{fontWeight:"bold",color:"#be123c"},children:[y.duration,"m"]})]},E))})]})]}),e.jsx("div",{style:{marginTop:"2rem"},children:e.jsxs("button",{className:"btn-primary",onClick:()=>o("/mood"),children:["Get Started ",e.jsx(xt,{size:18,style:{marginLeft:"0.5rem"}})]})}),m&&e.jsxs("div",{style:{marginTop:"3rem",textAlign:"left"},children:[e.jsxs("h3",{style:{display:"flex",alignItems:"center",gap:"0.5rem",color:"var(--color-text-secondary)"},children:[e.jsx(Ue,{size:18}),"Today's Live Snapshot"]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",justifyContent:"center",gap:"2rem",flexWrap:"wrap"},children:[e.jsxs("div",{style:{width:"160px",height:"160px",position:"relative"},children:[e.jsx(ce,{width:"100%",height:"100%",children:e.jsxs(Fe,{children:[e.jsxs(Ke,{data:[{name:"Work",value:m.workScore,color:"#10b981"},{name:"Procrastination",value:m.procrastinationScore,color:"#ef4444"}],dataKey:"value",innerRadius:50,outerRadius:70,startAngle:90,endAngle:-270,paddingAngle:5,children:[e.jsx(fe,{fill:"#10b981"},"work"),e.jsx(fe,{fill:"#ef4444"},"proc")]}),e.jsx(de,{})]})}),e.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center"},children:[e.jsxs("div",{style:{fontSize:"1.2rem",fontWeight:"bold",color:m.workScore>=50?"#10b981":"#ef4444"},children:[m.workScore,"%"]}),e.jsx("div",{style:{fontSize:"0.6rem",color:"var(--color-text-secondary)"},children:"Focus"})]})]}),e.jsxs("div",{style:{flex:1,minWidth:"150px"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{style:{textAlign:"center",padding:"0.5rem",background:"#f0fdf4",borderRadius:"8px"},children:[e.jsx("div",{style:{fontSize:"1.1rem",fontWeight:"bold",color:"#15803d"},children:m.tasksDoneCount||0}),e.jsx("div",{style:{fontSize:"0.7rem",color:"#166534"},children:"Tasks Done"})]}),e.jsxs("div",{style:{textAlign:"center",padding:"0.5rem",background:"#fafaebb",borderRadius:"8px",border:"1px solid #fef08a"},children:[e.jsx("div",{style:{fontSize:"1.1rem",fontWeight:"bold",color:"#854d0e"},children:m.pointsScored||0}),e.jsx("div",{style:{fontSize:"0.7rem",color:"#854d0e"},children:"Points"})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"0.85rem",color:"var(--color-text-secondary)"},children:[e.jsx("span",{children:"Worked:"}),e.jsxs("strong",{children:[m.workTime||0,"m"]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"0.85rem",color:"var(--color-text-secondary)",marginTop:"0.25rem"},children:[e.jsx("span",{children:"Distracted:"}),e.jsxs("strong",{children:[m.distractionTime||0,"m"]})]})]})]}),m.tomorrowGoal&&e.jsxs("div",{style:{padding:"0.75rem",background:"var(--color-bg-accent)",borderRadius:"var(--radius-md)",marginTop:"1rem"},children:[e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--color-text-secondary)",display:"flex",alignItems:"center",gap:"0.25rem",marginBottom:"0.25rem"},children:[e.jsx(Ie,{size:12}),new Date(m.date).toDateString()===new Date().toDateString()?"Goal for Tomorrow":"Target"]}),e.jsx("div",{style:{fontWeight:500,fontSize:"0.9rem"},children:m.tomorrowGoal})]})]})]})]})})},Xt=(o,t={})=>{const s=new Date;let r="night";if(t.overrideTimeOfDay)r=t.overrideTimeOfDay;else{const p=s.getHours();p>=5&&p<12?r="morning":p>=12&&p<17?r="afternoon":p>=17&&p<21&&(r="evening")}const{overrideTimeOfDay:n,...a}=t,i=x(d.USER_MOOD,"neutral");return{event_id:crypto.randomUUID(),user_id:$.currentUser?$.currentUser.uid:"local_user",timestamp:s.toISOString(),date:s.toISOString().split("T")[0],time_of_day:r,event_type:o,mood_before:i,payload:a,synced:!1}},ne=(o,t)=>{const s=Xt(o,t),r=x(d.EVENT_LOG,[]);r.push(s),R(d.EVENT_LOG,r),Zt()},Zt=async()=>{const o=$.currentUser;if(!o)return;const t=x(d.EVENT_LOG,[]),s=t.filter(r=>!r.synced);if(s.length!==0)try{const r=Ut(ge),n=Ft(ge,"users",o.uid,"events");s.forEach(i=>{const p=ve(n,i.event_id),{synced:u,...h}=i;r.set(p,h)}),await r.commit();const a=t.map(i=>s.find(p=>p.event_id===i.event_id)?{...i,synced:!0}:i);R(d.EVENT_LOG,a),console.log(`Synced ${s.length} events to cloud.`)}catch(r){console.error("Failed to sync events:",r)}},Qt=()=>{const o=G(),t=[{id:"focused",label:"Focused",icon:e.jsx(me,{size:32}),color:"var(--color-success)",desc:"I'm ready to tackle something big."},{id:"low-energy",label:"Low Energy",icon:e.jsx(ht,{size:32}),color:"var(--color-warning)",desc:"I need something small and easy."},{id:"bored",label:"Bored",icon:e.jsx(yt,{size:32}),color:"var(--color-text-accent)",desc:"I need to get interested."}],s=r=>{R(d.USER_MOOD,r),ne("mood_update",{mood:r}),o("/tasks")};return e.jsx(W,{children:e.jsxs("div",{className:"container",children:[e.jsx("h2",{style:{textAlign:"center",marginBottom:"1rem"},children:"How are you feeling right now?"}),e.jsx("div",{style:{display:"grid",gap:"1rem"},children:t.map(r=>e.jsxs("button",{onClick:()=>s(r.id),className:"card",style:{display:"flex",alignItems:"center",gap:"1rem",textAlign:"left",width:"100%",border:"1px solid transparent",cursor:"pointer",transition:"transform 0.2s, border-color 0.2s"},onMouseEnter:n=>{n.currentTarget.style.transform="scale(1.02)",n.currentTarget.style.borderColor=r.color},onMouseLeave:n=>{n.currentTarget.style.transform="scale(1)",n.currentTarget.style.borderColor="transparent"},children:[e.jsx("div",{style:{color:r.color},children:r.icon}),e.jsxs("div",{children:[e.jsx("strong",{style:{display:"block",fontSize:"1.1rem"},children:r.label}),e.jsx("span",{style:{fontSize:"0.9rem",color:"var(--color-text-secondary)"},children:r.desc})]})]},r.id))})]})})},er=()=>{const o=G(),[t,s]=c.useState([]),[r,n]=c.useState(null),[a,i]=c.useState([]),p=u=>{if(window.confirm("Are you sure you want to delete this task?")){const h=t.filter(w=>w.id!==u);s(h);const v=x(d.TASKS,[]).filter(w=>w.id!==u);R(d.TASKS,v)}};return c.useEffect(()=>{const u=x(d.USER_MOOD);n(u);const D=x(d.TASKS,[]).filter(I=>{var m;return!I.completed&&(((m=I.moods)==null?void 0:m.includes(u))||!I.moods||I.moods.length===0)});s(D);const v=x(d.SCHEDULED_TASKS,[]),w=new Date().setHours(0,0,0,0),L=v.filter(I=>{const m=new Date(I.startDate).setHours(0,0,0,0),f=new Date(I.dueDate).setHours(0,0,0,0);return!I.completed&&w>=m&&w<=f});i(L)},[]),e.jsx(W,{children:e.jsxs("div",{className:"container",children:[e.jsxs("button",{onClick:()=>o("/schedule"),style:{background:"transparent",border:"none",color:"var(--color-primary)",display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0",fontSize:"1rem",cursor:"pointer",marginBottom:"1rem"},children:[e.jsx(q,{size:20})," Back"]}),a.length>0&&e.jsxs("div",{style:{background:"var(--color-bg-accent)",padding:"1rem",borderRadius:"var(--radius-md)",marginBottom:"1.5rem",border:"1px solid var(--color-primary)"},children:[e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"start",color:"var(--color-primary)",marginBottom:"0.5rem"},children:[e.jsx(Ee,{size:20,style:{marginTop:"0.1rem"}}),e.jsxs("strong",{style:{display:"block"},children:["Daily Commitments (",a.length,")"]})]}),a.map(u=>e.jsx("div",{style:{marginLeft:"1.75rem",marginBottom:"0.5rem",borderBottom:"1px solid #e2e8f0",paddingBottom:"0.5rem"},children:e.jsxs("span",{style:{color:"var(--color-text-primary)"},children:["Planned to work on ",e.jsx("strong",{children:u.workToComplete})," for the ",e.jsx("strong",{children:u.name}),"."]})},u.id))]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[e.jsx("h2",{children:"Suggested for You"}),e.jsxs("button",{className:"btn-primary",style:{padding:"0.5rem 1rem",display:"flex",alignItems:"center",gap:"0.5rem"},onClick:()=>o("/add-task"),children:[e.jsx(he,{size:18})," Add Task"]})]}),t.length===0?e.jsxs("div",{style:{textAlign:"center",color:"var(--color-text-secondary)",padding:"2rem"},children:[e.jsxs("p",{children:["No tasks fit your current mood (",r,")."]}),e.jsx("p",{children:"Why not add a small one?"})]}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:t.map(u=>e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start"},children:e.jsxs("div",{children:[e.jsx("h3",{style:{margin:"0 0 0.25rem",fontSize:"1.25rem"},children:u.title}),e.jsxs("p",{style:{fontSize:"0.9rem",marginBottom:"0.5rem"},children:[e.jsx("strong",{children:"Start with:"})," ",u.smallStep]}),e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.85rem",color:"var(--color-text-secondary)"},children:u.time&&e.jsxs(e.Fragment,{children:[e.jsx(Me,{size:16})," ",u.time]})})]})}),e.jsxs("div",{style:{marginTop:"1rem",textAlign:"right"},children:[e.jsx("button",{className:"btn-primary",style:{background:"var(--color-success)",fontSize:"0.9rem"},onClick:()=>o(`/complete/${u.id}`),children:"Task Done (Add Proof)"}),e.jsx("button",{style:{background:"transparent",border:"none",color:"#ef4444",marginLeft:"1rem",cursor:"pointer",padding:"0.5rem"},onClick:()=>p(u.id),"aria-label":"Delete task",children:e.jsx(pe,{size:18})})]})]},u.id))})]})})},tr=()=>{const o=G(),[t,s]=c.useState({title:"",smallStep:"",moods:[]}),r=[{id:"focused",label:"Focused"},{id:"low-energy",label:"Low Energy"},{id:"bored",label:"Bored"}],n=i=>{i.preventDefault();const p=x(d.TASKS,[]),u={id:Date.now().toString(),...t,completed:!1,createdAt:new Date().toISOString()};R(d.TASKS,[u,...p]),ne("task_create",{task_id:u.id,title:u.title}),o("/tasks")},a=i=>{s(p=>{const u=p.moods.includes(i)?p.moods.filter(h=>h!==i):[...p.moods,i];return{...p,moods:u}})};return e.jsx(W,{children:e.jsxs("div",{className:"container",children:[e.jsxs("button",{onClick:()=>o("/schedule"),style:{background:"transparent",border:"none",color:"var(--color-primary)",display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0",fontSize:"1rem",cursor:"pointer",marginBottom:"1rem"},children:[e.jsx(q,{size:20})," Back"]}),e.jsx("h2",{children:"Add a New Task"}),e.jsxs("form",{onSubmit:n,className:"card",children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{children:"Task Name"}),e.jsx("input",{required:!0,value:t.title,onChange:i=>s({...t,title:i.target.value}),placeholder:"e.g. Study Math"})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{children:"Small First Step (Crucial!)"}),e.jsx("input",{required:!0,value:t.smallStep,onChange:i=>s({...t,smallStep:i.target.value}),placeholder:"e.g. Open the textbook to page 50"}),e.jsx("small",{style:{color:"var(--color-text-secondary)"},children:"Just write what you will do in the first 2 minutes."})]}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("label",{children:"Best for Mood (Optional)"}),e.jsx("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:r.map(i=>e.jsx("button",{type:"button",onClick:()=>a(i.id),style:{padding:"0.5rem 1rem",borderRadius:"var(--radius-full)",border:"1px solid var(--color-primary)",background:t.moods.includes(i.id)?"var(--color-primary)":"transparent",color:t.moods.includes(i.id)?"white":"var(--color-primary)",fontSize:"0.85rem"},children:i.label},i.id))})]}),e.jsx("button",{type:"submit",className:"btn-primary",style:{width:"100%"},children:"Save Task"})]})]})})},ze=({value:o,onChange:t})=>e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",marginTop:"0.5rem"},children:[["15","30","45","60"].map(s=>e.jsxs("button",{type:"button",onClick:()=>t(s),style:{padding:"0.5rem 1rem",borderRadius:"2rem",border:"1px solid var(--color-primary)",background:o===s?"var(--color-primary)":"transparent",color:o===s?"white":"var(--color-primary)",cursor:"pointer",transition:"all 0.2s"},children:[s,"m"]},s)),e.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",placeholder:"Custom (max 600)",value:o,onChange:s=>{const r=s.target.value;(r===""||/^\d+$/.test(r)&&parseInt(r,10)<=600)&&t(r)},style:{width:"120px",padding:"0.5rem",borderRadius:"var(--radius-md)",border:"1px solid #cbd5e1",outlineColor:"var(--color-primary)"}})]}),je=({value:o,onChange:t,compact:s=!1})=>{const r=[{id:"morning",label:"Morning",icon:e.jsx(Ce,{size:20}),color:"#f59e0b"},{id:"afternoon",label:"Afternoon",icon:e.jsx(ft,{size:20}),color:"#ea580c"},{id:"evening",label:"Evening",icon:e.jsx(jt,{size:20}),color:"#7c3aed"},{id:"night",label:"Night",icon:e.jsx(De,{size:20}),color:"#1e293b"}];return e.jsxs("div",{style:{marginBottom:s?0:"1.5rem"},children:[!s&&e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"var(--color-text-secondary)"},children:"When did this happen?"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:s?"repeat(4, auto)":"repeat(4, 1fr)",gap:s?"0.25rem":"0.5rem"},children:r.map(n=>e.jsxs("button",{type:"button",onClick:()=>t(n.id),title:s?n.label:"",style:{display:"flex",flexDirection:s?"row":"column",alignItems:"center",justifyContent:"center",gap:"0.25rem",padding:s?"0.4rem":"0.75rem 0.25rem",borderRadius:"var(--radius-md)",border:`1px solid ${o===n.id?n.color:"transparent"}`,background:o===n.id?`${n.color}15`:"var(--color-bg-secondary)",color:o===n.id?n.color:"var(--color-text-secondary)",cursor:"pointer",transition:"all 0.2s"},children:[n.icon,!s&&e.jsx("span",{style:{fontSize:"0.75rem",fontWeight:o===n.id?"600":"400"},children:n.label})]},n.id))})]})},rr=()=>{const{taskId:o}=vt(),t=G(),[s,r]=c.useState(null),[n,a]=c.useState(""),[i,p]=c.useState(""),[u,h]=c.useState(null),D=c.useRef(null),v=c.useRef(null),[w,L]=c.useState(!1),[I,m]=c.useState(0),[f,j]=c.useState("morning");c.useEffect(()=>{const y=new Date().getHours();y>=5&&y<12?j("morning"):y>=12&&y<17?j("afternoon"):y>=17&&y<21?j("evening"):j("night")},[]),c.useEffect(()=>{let E=x(d.TASKS,[]).find(z=>z.id===o);if(!E){const K=x(d.SCHEDULED_TASKS,[]).find(b=>String(b.id)===o);K&&(E={...K,title:K.name,smallStep:K.workToComplete||"Scheduled Work",isSchedule:!0})}E&&r(E)},[o]);const U=y=>{const E=y.target.files[0];if(E){const z=new FileReader;z.onloadend=()=>{h(z.result)},z.readAsDataURL(E)}},_=y=>{y.preventDefault();const E=new Date().setHours(0,0,0,0);let z=10;if(s.isSchedule){const b=new Date(s.dueDate).setHours(0,0,0,0);E<=b?z=100:z=10}const K=parseInt(i)||0;if(z+=K,s.isSchedule){const O=x(d.SCHEDULED_TASKS,[]).map(B=>String(B.id)===o?{...B,completed:!0,completedAt:new Date().toISOString(),timeTaken:parseInt(i)||0,proofImage:u,pointsEarned:z}:B);R(d.SCHEDULED_TASKS,O)}else{const O=x(d.TASKS,[]).map(B=>B.id===o?{...B,completed:!0,learning:n,completedAt:new Date().toISOString(),timeTaken:parseInt(i)||0,proofImage:u,pointsEarned:z}:B);R(d.TASKS,O)}Te(z),et(),ne("task_complete",{task_id:o,task_title:s.title,actual_time_spent:parseInt(i)||0,points_earned:z,has_proof:!!u,learning_note:n,overrideTimeOfDay:f}),m(z),L(!0)};return s?w?e.jsx(W,{children:e.jsxs("div",{className:"container",style:{textAlign:"center",padding:"3rem 1rem"},children:[e.jsx(ue,{size:64,color:"var(--color-success)",style:{margin:"0 auto 1rem"}}),e.jsx("h2",{children:"Well Done!"}),e.jsx("p",{children:"You started despite resistance. That matters."}),e.jsxs("div",{style:{margin:"2rem 0",padding:"1.5rem",background:"var(--color-bg-accent)",borderRadius:"var(--radius-lg)"},children:[e.jsxs("h3",{style:{margin:0,color:"var(--color-primary)"},children:["+",I," Focus Points"]}),e.jsx("p",{style:{margin:"0.5rem 0 0"},children:"Streak Updated!"})]}),e.jsx("button",{className:"btn-primary",onClick:()=>t("/"),children:"Back Home"})]})}):e.jsx(W,{children:e.jsxs("div",{className:"container",children:[e.jsxs("h2",{children:['Complete "',s.title,'"']}),e.jsx("div",{className:"card",children:e.jsxs("form",{onSubmit:_,children:[e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("label",{children:"Time Taken (minutes)"}),e.jsx(ze,{value:i,onChange:p})]}),e.jsx(je,{value:f,onChange:j}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("label",{children:"What did you learn or do? (Optional)"}),e.jsx("textarea",{value:n,onChange:y=>a(y.target.value),placeholder:"I learned that starting wasn't so bad...",rows:2})]}),e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem"},children:"Upload Proof (Optional)"}),e.jsx("input",{type:"file",accept:"image/*",ref:D,onChange:U,style:{display:"none"}}),e.jsx("input",{type:"file",accept:"image/*",capture:"environment",id:"cameraInput",ref:v,onChange:U,style:{display:"none"}}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{onClick:()=>{var y;return(y=D.current)==null?void 0:y.click()},style:{border:"2px dashed #cbd5e1",borderRadius:"var(--radius-md)",padding:"1.5rem",textAlign:"center",color:"var(--color-text-secondary)",cursor:"pointer",background:u?"#f0fdf4":"transparent"},children:[e.jsx(He,{size:24,style:{marginBottom:"0.5rem"}}),e.jsx("div",{children:"Upload Image"})]}),e.jsxs("div",{onClick:()=>{var y;return(y=v.current)==null?void 0:y.click()},style:{border:"2px dashed #cbd5e1",borderRadius:"var(--radius-md)",padding:"1.5rem",textAlign:"center",color:"var(--color-text-secondary)",cursor:"pointer",background:u?"#f0fdf4":"transparent"},children:[e.jsx(Ge,{size:24,style:{marginBottom:"0.5rem"}}),e.jsx("div",{children:"Take Photo"})]})]}),u&&e.jsx("div",{style:{marginTop:"0.5rem",fontSize:"0.875rem",color:"var(--color-success)",textAlign:"center"},children:"Proof Attached!"})]}),e.jsx("button",{type:"submit",className:"btn-primary",style:{width:"100%",opacity:i?1:.5,cursor:i?"pointer":"not-allowed"},disabled:!i,children:"Mark as Completed"})]})})]})}):e.jsx(W,{children:e.jsx("div",{children:"Loading..."})})},sr=()=>{const o=G(),[t,s]=c.useState([]),[r,n]=c.useState([]),[a,i]=c.useState(null),[p,u]=c.useState(""),[h,D]=c.useState("morning"),[v,w]=c.useState(!1),[L,I]=c.useState(!1),[m,f]=c.useState(!1),[j,U]=c.useState(""),[_,y]=c.useState(""),[E,z]=c.useState(null),K=c.useRef(null),b=c.useRef(null),[O,B]=c.useState("morning"),[N,g]=c.useState({name:"",workToComplete:"",startDate:"",dueDate:""}),[T,M]=c.useState({title:"",smallStep:"",moods:[]}),[X,Y]=c.useState(null),ee=[{id:"focused",label:"Focused"},{id:"low-energy",label:"Low Energy"},{id:"bored",label:"Bored"}];c.useEffect(()=>{s(x(d.SCHEDULED_TASKS,[])),n(x(d.TASKS,[]))},[]);const J=l=>{if(l.preventDefault(),!a||!p)return;const k=parseInt(p);if(isNaN(k)||k<=0)return;const A={id:Date.now().toString(),taskId:a.id,taskTitle:a.title||a.name,duration:k,timeOfDay:h,date:new Date().toISOString()},F=x(d.WORK_LOGS,[]);R(d.WORK_LOGS,[...F,A]),Te(k),i(null),u(""),alert(`Logged ${k} mins of work! Keep it up.`)},xe=l=>{if(l.preventDefault(),X){const k=t.map(A=>A.id===X?{...A,...N}:A);R(d.SCHEDULED_TASKS,k),s(k),Y(null)}else{const k=[...t,{id:Date.now(),...N}];R(d.SCHEDULED_TASKS,k),s(k)}w(!1),g({name:"",workToComplete:"",startDate:"",dueDate:""})},te=l=>{g({name:l.name,workToComplete:l.workToComplete||"",startDate:l.startDate,dueDate:l.dueDate}),Y(l.id),w(!0),I(!1),f(!1)},re=l=>{l.preventDefault();const A=[{id:Date.now().toString(),...T,completed:!1,createdAt:new Date().toISOString()},...r];R(d.TASKS,A),n(A),I(!1),M({title:"",smallStep:"",moods:[]})},se=l=>{if(window.confirm("Delete this daily task?")){const k=r.filter(A=>A.id!==l);n(k),R(d.TASKS,k)}},oe=l=>{if(window.confirm("Cancel this future plan?")){const k=t.filter(A=>A.id!==l);s(k),R(d.SCHEDULED_TASKS,k)}},ie=l=>{M(k=>{const A=k.moods.includes(l)?k.moods.filter(F=>F!==l):[...k.moods,l];return{...k,moods:A}})},Z=l=>{const k=l.target.files[0];if(k){const A=new FileReader;A.onloadend=()=>{z(A.result)},A.readAsDataURL(k)}},C=l=>{l.preventDefault();const A=10+(parseInt(_)||0),F=x(d.TASKS,[]),Q={id:Date.now().toString(),title:j,smallStep:"Ad-hoc Logged",time:_,completed:!0,completedAt:new Date().toISOString(),timeTaken:parseInt(_)||0,proofImage:E,isAdhoc:!0,pointsEarned:A};R(d.TASKS,[Q,...F]),n([Q,...F]),Te(A),et(),ne("task_complete",{task_id:Q.id,task_title:Q.title,actual_time_spent:parseInt(_)||0,points_earned:A,has_proof:!!E,is_adhoc:!0}),alert(`Saved! +${A} Points.`),f(!1),U(""),y(""),z(null)};return e.jsx(W,{children:e.jsxs("div",{className:"container",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"2rem"},children:[e.jsxs("button",{onClick:()=>o("/"),style:{background:"var(--color-bg-secondary)",border:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",color:"var(--color-primary)",padding:"0.5rem 1rem",borderRadius:"2rem",fontWeight:"500",marginRight:"1rem"},children:[e.jsx(q,{size:18})," Back"]}),e.jsx("h2",{style:{margin:0},children:"Planning Hub"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"3rem"},children:[e.jsxs("div",{className:"card",style:{textAlign:"center",cursor:"pointer",border:L?"2px solid var(--color-primary)":"1px solid transparent",transition:"all 0.2s",padding:"2rem 1rem"},onClick:()=>{I(!L),w(!1),f(!1)},children:[e.jsx("div",{style:{background:"var(--color-bg-accent)",width:"48px",height:"48px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1rem",color:"var(--color-primary)"},children:e.jsx(me,{size:24})}),e.jsx("h3",{style:{fontSize:"1.2rem",margin:"0 0 0.5rem"},children:"Add Task"}),e.jsx("p",{style:{fontSize:"0.9rem",color:"var(--color-text-secondary)",margin:0},children:"For immediate work today. Small steps."})]}),e.jsxs("div",{className:"card",style:{textAlign:"center",cursor:"pointer",border:v?"2px solid var(--color-primary)":"1px solid transparent",padding:"2rem 1rem"},onClick:()=>{w(!v),I(!1),f(!1)},children:[e.jsx("div",{style:{background:"#f0f9ff",width:"48px",height:"48px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1rem",color:"#0284c7"},children:e.jsx(Ie,{size:24})}),e.jsx("h3",{style:{fontSize:"1.2rem",margin:"0 0 0.5rem"},children:"Schedule Future Task"}),e.jsx("p",{style:{fontSize:"0.9rem",color:"var(--color-text-secondary)",margin:0},children:"Plan ahead to reduce uncertainty."})]})]}),L&&e.jsxs("div",{style:{animation:"fadeIn 0.3s ease-in-out"},children:[e.jsx("h3",{style:{marginBottom:"1rem"},children:"Add a New Task"}),e.jsxs("form",{onSubmit:re,className:"card",style:{marginBottom:"3rem",borderLeft:"4px solid var(--color-primary)"},children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{children:"Task Name"}),e.jsx("input",{required:!0,value:T.title,onChange:l=>M({...T,title:l.target.value}),placeholder:"e.g. Study Math",autoFocus:!0})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{children:"Small First Step (Crucial!)"}),e.jsx("input",{required:!0,value:T.smallStep,onChange:l=>M({...T,smallStep:l.target.value}),placeholder:"e.g. Open the textbook to page 50"}),e.jsx("small",{style:{color:"var(--color-text-secondary)"},children:"Just write what you will do in the first 2 minutes."})]}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("label",{children:"Best for Mood (Optional)"}),e.jsx("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:ee.map(l=>e.jsx("button",{type:"button",onClick:()=>ie(l.id),style:{padding:"0.5rem 1rem",borderRadius:"var(--radius-full)",border:"1px solid var(--color-primary)",background:T.moods.includes(l.id)?"var(--color-primary)":"transparent",color:T.moods.includes(l.id)?"white":"var(--color-primary)",fontSize:"0.85rem"},children:l.label},l.id))})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("button",{type:"button",onClick:()=>I(!1),className:"btn-secondary",style:{flex:1},children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",style:{flex:1},children:"Save Task"})]})]})]}),v&&e.jsxs("div",{style:{animation:"fadeIn 0.3s ease-in-out"},children:[e.jsx("h3",{style:{marginBottom:"1rem"},children:X?"Edit Plan":"New Future Plan"}),e.jsxs("form",{onSubmit:xe,className:"card",style:{marginBottom:"3rem",borderLeft:"4px solid #0284c7"},children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{children:"Task Name"}),e.jsx("input",{required:!0,value:N.name,onChange:l=>g({...N,name:l.target.value}),autoFocus:!0})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{children:"Work to Complete"}),e.jsx("input",{value:N.workToComplete,onChange:l=>g({...N,workToComplete:l.target.value}),placeholder:"e.g. Read Chapters 1-3"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{children:"Start Date"}),e.jsx("input",{type:"date",required:!0,value:N.startDate,onChange:l=>g({...N,startDate:l.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Due Date"}),e.jsx("input",{type:"date",required:!0,value:N.dueDate,onChange:l=>g({...N,dueDate:l.target.value})})]})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("button",{type:"button",onClick:()=>w(!1),className:"btn-secondary",style:{flex:1},children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",style:{flex:1},children:"Save Plan"})]})]})]}),m&&e.jsxs("div",{style:{animation:"fadeIn 0.3s ease-in-out"},children:[e.jsx("h3",{style:{marginBottom:"1rem"},children:"Log Unplanned Work"}),e.jsxs("form",{onSubmit:C,className:"card",style:{marginBottom:"3rem",borderLeft:"4px solid #8b5cf6"},children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{children:"What did you do?"}),e.jsx("input",{required:!0,value:j,onChange:l=>U(l.target.value),placeholder:"e.g. Helper a friend",autoFocus:!0})]}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("label",{children:"Time Taken (minutes)"}),e.jsx(ze,{value:_,onChange:y})]}),e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem"},children:"Upload Proof (Optional)"}),e.jsx("input",{type:"file",accept:"image/*",ref:K,onChange:Z,style:{display:"none"}}),e.jsx("input",{type:"file",accept:"image/*",capture:"environment",ref:b,onChange:Z,style:{display:"none"}}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{onClick:()=>{var l;return(l=K.current)==null?void 0:l.click()},style:{border:"2px dashed #cbd5e1",borderRadius:"var(--radius-md)",padding:"1rem",textAlign:"center",cursor:"pointer",background:E?"#f0fdf4":"transparent"},children:[e.jsx(He,{size:24,style:{marginBottom:"0.5rem"}}),e.jsx("div",{children:"Upload"})]}),e.jsxs("div",{onClick:()=>{var l;return(l=b.current)==null?void 0:l.click()},style:{border:"2px dashed #cbd5e1",borderRadius:"var(--radius-md)",padding:"1rem",textAlign:"center",cursor:"pointer",background:E?"#f0fdf4":"transparent"},children:[e.jsx(Ge,{size:24,style:{marginBottom:"0.5rem"}}),e.jsx("div",{children:"Camera"})]})]}),E&&e.jsx("div",{style:{marginTop:"0.5rem",fontSize:"0.875rem",color:"var(--color-success)",textAlign:"center"},children:"Proof Attached!"})]}),e.jsx(je,{value:O,onChange:B}),e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("button",{type:"button",onClick:()=>f(!1),className:"btn-secondary",style:{flex:1},children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",style:{flex:1,opacity:_?1:.5,cursor:_?"pointer":"not-allowed"},disabled:!_,children:"Save Work"})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1.5rem"},children:[e.jsx(St,{size:20,className:"text-secondary"}),e.jsx("h3",{style:{margin:0,color:"var(--color-text-secondary)"},children:"Your Plans"}),e.jsx("div",{style:{flex:1}}),e.jsx("button",{onClick:()=>{f(!m),I(!1),w(!1)},style:{background:"var(--color-bg-secondary)",border:"none",padding:"0.5rem 1rem",borderRadius:"var(--radius-full)",color:"var(--color-primary)",fontSize:"0.85rem",fontWeight:"500",cursor:"pointer"},children:"+ Log Other Task"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[r.length>0&&r.some(l=>!l.completed)&&e.jsx("h4",{style:{margin:"1rem 0 0.5rem",color:"var(--color-primary)",borderBottom:"1px solid #e2e8f0",paddingBottom:"0.25rem"},children:"Daily Commitments"}),r.filter(l=>!l.completed).map(l=>e.jsxs("div",{className:"card",style:{borderLeft:"4px solid var(--color-warning)"},children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start"},children:e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.25rem"},children:[e.jsx("h3",{style:{margin:0},children:l.title}),e.jsx("span",{style:{fontSize:"0.75rem",background:"#fef3c7",color:"#d97706",padding:"0.1rem 0.4rem",borderRadius:"4px"},children:"Now"})]}),e.jsx("p",{style:{margin:"0 0 0.5rem",color:"var(--color-text-primary)"},children:l.smallStep})]})}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:"1rem",paddingTop:"0.75rem",borderTop:"1px solid #eee",gap:"0.5rem"},children:[e.jsxs("button",{className:"btn-primary",style:{background:"var(--color-success)",fontSize:"0.85rem",padding:"0.5rem 1rem"},onClick:()=>o(`/complete/${l.id}`),children:[e.jsx(ue,{size:16,style:{marginRight:"0.25rem"}})," Task Done"]}),e.jsxs("button",{style:{background:"#fee2e2",border:"none",color:"#ef4444",cursor:"pointer",padding:"0.5rem 1rem",borderRadius:"2rem",fontSize:"0.85rem",display:"flex",alignItems:"center",gap:"0.25rem"},onClick:()=>se(l.id),children:[e.jsx(pe,{size:16})," Delete"]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--color-text-secondary)",marginLeft:"auto"},children:l.time&&`${l.time}m`})]})]},l.id)),t.length>0&&e.jsx("h4",{style:{margin:"1.5rem 0 0.5rem",color:"#0284c7",borderBottom:"1px solid #e2e8f0",paddingBottom:"0.25rem"},children:"Future Schedule"}),t.map(l=>{const k=new Date().setHours(0,0,0,0),A=new Date(l.startDate).setHours(0,0,0,0),F=new Date(l.dueDate).setHours(0,0,0,0),Q=k>=A&&k<=F;return F<k||l.completed?null:e.jsxs("div",{className:"card",style:{borderLeft:"4px solid var(--color-primary)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{margin:"0 0 0.25rem"},children:l.name}),e.jsx("p",{style:{margin:"0 0 0.5rem",color:"var(--color-text-primary)"},children:l.workToComplete})]}),Q&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",color:"var(--color-primary)",fontSize:"0.8rem",fontWeight:"bold",background:"var(--color-bg-accent)",padding:"0.25rem 0.5rem",borderRadius:"var(--radius-md)"},children:[e.jsx(Ee,{size:14}),"Active Today"]})]}),e.jsxs("div",{style:{marginTop:"0.5rem",marginBottom:"1rem",fontSize:"0.85rem",color:"var(--color-text-secondary)"},children:[e.jsxs("span",{style:{marginRight:"1rem"},children:["Start: ",l.startDate]}),e.jsxs("span",{children:["Due: ",l.dueDate]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",flexWrap:"wrap",gap:"0.75rem",marginTop:"1rem",paddingTop:"1rem",borderTop:"1px solid #e2e8f0"},children:[e.jsxs("button",{className:"btn-secondary",style:{fontSize:"0.8rem",padding:"0.5rem 1rem",display:"flex",alignItems:"center",gap:"0.25rem"},onClick:()=>i(l),children:[e.jsx(me,{size:14})," Done some work"]}),e.jsxs("button",{className:"btn-primary",style:{background:"var(--color-success)",fontSize:"0.85rem",padding:"0.5rem 1rem",display:"flex",alignItems:"center",gap:"0.25rem"},onClick:()=>o(`/complete/${l.id}`),children:[e.jsx(ue,{size:16})," Task Done"]}),e.jsxs("button",{onClick:()=>te(l),style:{background:"#fef3c7",color:"#d97706",border:"none",cursor:"pointer",padding:"0.5rem 1rem",borderRadius:"2rem",fontSize:"0.8rem",display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx($e,{size:14})," Edit"]}),e.jsxs("button",{style:{background:"#fee2e2",border:"none",color:"#ef4444",cursor:"pointer",padding:"0.5rem 1rem",borderRadius:"2rem",fontSize:"0.8rem",display:"flex",alignItems:"center",gap:"0.25rem"},onClick:()=>oe(l.id),children:[e.jsx(pe,{size:14})," Delete"]})]}),(a==null?void 0:a.id)===l.id&&e.jsxs("div",{style:{marginTop:"1rem",padding:"1rem",background:"var(--color-bg-secondary)",borderRadius:"var(--radius-md)"},children:[e.jsx("h4",{style:{margin:"0 0 0.5rem"},children:"Log Work (Not Done Yet)"}),e.jsxs("form",{onSubmit:J,style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",placeholder:"Mins",value:p,onChange:Re=>{const V=Re.target.value;(V===""||/^\d+$/.test(V)&&parseInt(V,10)<=600)&&u(V)},style:{width:"80px",padding:"0.5rem",borderRadius:"4px",border:"1px solid #cbd5e1"},autoFocus:!0}),e.jsx(je,{value:h,onChange:D,compact:!0})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{type:"submit",className:"btn-primary",style:{padding:"0.25rem 0.75rem",fontSize:"0.85rem",flex:1,opacity:p?1:.5},disabled:!p,children:[e.jsx(bt,{size:14})," Save"]}),e.jsx("button",{type:"button",onClick:()=>{i(null),u("")},style:{background:"transparent",border:"none",cursor:"pointer",color:"var(--color-text-secondary)"},children:e.jsx(Ye,{size:18})})]})]})]})]},l.id)}),r.length===0&&t.length===0&&e.jsx("p",{style:{textAlign:"center",padding:"2rem",background:"var(--color-bg-secondary)",borderRadius:"var(--radius-md)"},children:"No plans yet. Clear mind, clear path."})]})]})]})})},nr=()=>{const o=G(),[t,s]=c.useState(0),[r,n]=c.useState(0),[a,i]=c.useState(""),[p,u]=c.useState([]),[h,D]=c.useState([]),[v,w]=c.useState([]),[L,I]=c.useState(!1),[m,f]=c.useState(0),[j,U]=c.useState(0),[_,y]=c.useState(0),[E,z]=c.useState(0);c.useEffect(()=>{const b=new Date().setHours(0,0,0,0),B=x(d.DISTRACTION_LOGS,[]).filter(C=>new Date(C.date).setHours(0,0,0,0)===b);u(B);const N=B.reduce((C,l)=>C+parseInt(l.duration||0),0);U(N);const g=x(d.TASKS,[]),T=x(d.SCHEDULED_TASKS,[]),M=g.filter(C=>!C.completed||!C.completedAt?!1:new Date(C.completedAt).setHours(0,0,0,0)===b),X=T.filter(C=>!C.completed||!C.completedAt?!1:new Date(C.completedAt).setHours(0,0,0,0)===b),Y=[...M,...X];D(Y);const J=x(d.WORK_LOGS,[]).filter(C=>new Date(C.date).setHours(0,0,0,0)===b);w(J);const xe=Y.reduce((C,l)=>C+(parseInt(l.timeTaken)||0),0),te=J.reduce((C,l)=>C+parseInt(l.duration||0),0),re=xe+te;f(re);const se=Y.length+J.length;y(se);const oe=Y.reduce((C,l)=>l.pointsEarned!==void 0?C+l.pointsEarned:C+10+(parseInt(l.timeTaken)||0),0),ie=J.reduce((C,l)=>C+(parseInt(l.duration)||0),0);z(oe+ie);const Z=re+N;if(Z>0){const C=Math.round(N/Z*100);s(C),n(100-C)}else n(0),s(0)},[]);const K=b=>{b.preventDefault();const O=x(d.REFLECTIONS,[]),B={id:Date.now(),date:new Date().toISOString(),procrastinationScore:t,workScore:r,tomorrowGoal:a,distractionCount:p.length,distractionTime:j,tasksDoneCount:_,taskTime:m,pointsScored:E};R(d.REFLECTIONS,[B,...O]),ne("diary_entry",{procrastination_score:t,work_score:r,tomorrow_goal:a,total_distraction_time:j,total_work_time:m}),I(!0)};return L?e.jsx(W,{children:e.jsxs("div",{className:"container",style:{textAlign:"center",paddingTop:"3rem"},children:[e.jsx("div",{style:{fontSize:"4rem",marginBottom:"1rem"},children:"üåô"}),e.jsx("h2",{children:"Reflection Saved"}),e.jsx("p",{children:"Rest well. Tomorrow is a fresh start."}),e.jsx("button",{className:"btn-primary",onClick:()=>o("/"),style:{marginTop:"2rem"},children:"Back Home"}),e.jsxs("div",{style:{marginTop:"2rem",padding:"1.5rem",background:"var(--color-bg-accent)",borderRadius:"var(--radius-lg)",textAlign:"left"},children:[e.jsx("h3",{style:{fontSize:"1.1rem",marginTop:0},children:"Target for Tomorrow:"}),e.jsx("p",{style:{fontSize:"1.2rem",color:"var(--color-primary)",fontWeight:600},children:a})]})]})}):e.jsx(W,{children:e.jsxs("div",{className:"container",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"2rem"},children:[e.jsxs("button",{onClick:()=>o("/"),style:{background:"var(--color-bg-secondary)",border:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",color:"var(--color-primary)",padding:"0.5rem 1rem",borderRadius:"2rem",fontWeight:"500",marginRight:"1rem"},children:[e.jsx(q,{size:18})," Back"]}),e.jsx("h2",{style:{margin:0},children:"Today's Reflection"})]}),e.jsxs("form",{onSubmit:K,children:[e.jsxs("div",{className:"card",style:{marginBottom:"1.5rem",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-around",flexWrap:"wrap"},children:[e.jsxs("div",{style:{width:"180px",height:"180px",position:"relative"},children:[e.jsx(ce,{width:"100%",height:"100%",children:e.jsxs(Fe,{children:[e.jsxs(Ke,{data:[{name:"Work",value:r,color:"#10b981"},{name:"Procrastination",value:t,color:"#ef4444"}],dataKey:"value",innerRadius:60,outerRadius:80,startAngle:90,endAngle:-270,paddingAngle:5,children:[e.jsx(fe,{fill:"#10b981"},"work"),e.jsx(fe,{fill:"#ef4444"},"proc")]}),e.jsx(de,{})]})}),e.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center"},children:[e.jsxs("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:r>=50?"#10b981":"#ef4444"},children:[r,"%"]}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--color-text-secondary)"},children:"Focus"})]})]}),e.jsxs("div",{style:{textAlign:"left",padding:"1rem"},children:[e.jsx("h3",{style:{margin:"0 0 0.5rem",fontSize:"1.2rem"},children:"Day Summary"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.9rem"},children:[e.jsx("div",{style:{width:"12px",height:"12px",borderRadius:"50%",background:"#10b981"}}),e.jsxs("span",{children:["Productive: ",e.jsxs("strong",{children:[m,"m"]})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.9rem"},children:[e.jsx("div",{style:{width:"12px",height:"12px",borderRadius:"50%",background:"#ef4444"}}),e.jsxs("span",{children:["Distracted: ",e.jsxs("strong",{children:[j,"m"]})]})]}),e.jsxs("div",{style:{marginTop:"0.5rem",fontSize:"0.85rem",color:"var(--color-text-secondary)"},children:["Tasks Done: ",e.jsx("strong",{children:_})," | Points: ",e.jsx("strong",{children:E})]})]})]})]}),e.jsxs("div",{className:"card",style:{marginBottom:"2rem"},children:[e.jsxs("h3",{style:{fontSize:"1.1rem",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Ue,{size:18})," Activity Log"]}),h.length===0&&p.length===0&&v.length===0?e.jsx("p",{style:{color:"var(--color-text-secondary)",fontStyle:"italic",textAlign:"center",padding:"1rem"},children:"No activity recorded yet."}):e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[h.map((b,O)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid var(--color-bg-secondary)"},children:[e.jsx("div",{style:{padding:"0.5rem",borderRadius:"50%",background:"#dcfce7",color:"#15803d"},children:e.jsx(ue,{size:16})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:500},children:b.title||b.name}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--color-text-secondary)"},children:"Completed Task"})]}),e.jsxs("div",{style:{fontWeight:"bold",color:"#15803d"},children:[b.timeTaken||0,"m"]})]},`task-${O}`)),v.map((b,O)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid var(--color-bg-secondary)"},children:[e.jsx("div",{style:{padding:"0.5rem",borderRadius:"50%",background:"#dbeafe",color:"#1d4ed8"},children:e.jsx(Me,{size:16})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:500},children:b.taskTitle}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--color-text-secondary)"},children:"Work Session"})]}),e.jsxs("div",{style:{fontWeight:"bold",color:"#1d4ed8"},children:[b.duration,"m"]})]},`log-${O}`)),p.map((b,O)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid var(--color-bg-secondary)"},children:[e.jsx("div",{style:{padding:"0.5rem",borderRadius:"50%",background:"#fee2e2",color:"#b91c1c"},children:e.jsx(Ae,{size:16})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:500},children:b.app}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--color-text-secondary)"},children:b.reasons.join(", ")})]}),e.jsxs("div",{style:{fontWeight:"bold",color:"#b91c1c"},children:[b.duration,"m"]})]},`dist-${O}`))]})]}),e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx(kt,{size:18})," Goal for Tomorrow"]}),e.jsx("input",{required:!0,value:a,onChange:b=>i(b.target.value),placeholder:"e.g. Finish the Math Chapter without phone",style:{width:"100%",padding:"0.75rem",borderRadius:"var(--radius-md)",border:"1px solid #cbd5e1"}})]}),e.jsx("button",{type:"submit",className:"btn-primary",style:{width:"100%",padding:"1rem"},children:"Save & Close Day"})]})]})})},or=()=>{const o=G(),[t,s]=c.useState("initial"),[r,n]=c.useState([]),[a,i]=c.useState(""),[p,u]=c.useState(""),[h,D]=c.useState([]),[v,w]=c.useState(null),[L,I]=c.useState(null),[m,f]=c.useState([]),[j,U]=c.useState(""),[_,y]=c.useState("morning");c.useEffect(()=>{const g=new Date().getHours();g>=5&&g<12?y("morning"):g>=12&&g<17?y("afternoon"):g>=17&&g<21?y("evening"):y("night")},[]),c.useEffect(()=>{const g=x("sp_distraction_types",[]);n(g)},[]);const E=()=>{if(!a)return;let g;v?g=r.map(T=>T.id===v?{...T,name:a,reasons:h.length>0?h:["General"]}:T):g=[...r,{id:Date.now(),name:a,reasons:h.length>0?h:["General"]}],R("sp_distraction_types",g),n(g),i(""),D([]),u(""),w(null),s("initial")},z=g=>{i(g.name),D(g.reasons),w(g.id)},K=g=>{if(window.confirm("Delete this distraction type?")){const T=r.filter(M=>M.id!==g);n(T),R("sp_distraction_types",T),v===g&&(w(null),i(""),D([]))}},b=()=>{p&&(D([...h,p]),u(""))},O=g=>{g.preventDefault();const T=x(d.DISTRACTION_LOGS,[]),M={id:Date.now(),app:L.name,reasons:m,duration:j,date:new Date().toISOString()};R(d.DISTRACTION_LOGS,[M,...T]),ne("distraction_log",{app:L.name,reasons:m,duration:parseInt(j)||0,overrideTimeOfDay:_}),s("success")},B=g=>{m.includes(g)?f(m.filter(T=>T!==g)):f([...m,g])},N=()=>{I(null),f([]),U("")};return t==="calm"?e.jsx(W,{children:e.jsxs("div",{className:"container",style:{textAlign:"center",paddingTop:"4rem"},children:[e.jsx("div",{style:{fontSize:"4rem",marginBottom:"1rem"},children:"üåø"}),e.jsx("h2",{children:"Great Job!"}),e.jsx("p",{children:"Focusing on your improvement is the best gift you can give yourself."}),e.jsx("button",{className:"btn-primary",onClick:()=>s("initial"),style:{marginTop:"2rem"},children:"Back"})]})}):t==="success"?e.jsx(W,{children:e.jsxs("div",{className:"container",style:{textAlign:"center",paddingTop:"4rem"},children:[e.jsx("h2",{children:"Logged."}),e.jsx("p",{children:"Awareness is the first step. Use this data tomorrow."}),e.jsx("button",{className:"btn-primary",onClick:()=>{s("initial"),N()},style:{marginTop:"2rem"},children:"Done"})]})}):t==="config"?e.jsx(W,{children:e.jsxs("div",{className:"container",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h2",{children:v?"Edit Distraction":"Add Distraction"}),e.jsx("button",{onClick:()=>s("initial"),style:{background:"none",border:"none",cursor:"pointer"},children:e.jsx(Ye,{})})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{children:"Distraction Name"}),e.jsx("input",{value:a,onChange:g=>i(g.target.value),placeholder:"e.g. YouTube Shorts"})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{children:"Possible Reasons"}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx("input",{value:p,onChange:g=>u(g.target.value),placeholder:"e.g. Boredom"}),e.jsx("button",{type:"button",onClick:b,className:"btn-primary",style:{padding:"0.5rem"},children:e.jsx(he,{size:16})})]}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem"},children:h.map((g,T)=>e.jsx("span",{style:{background:"#f1f5f9",padding:"0.25rem 0.5rem",borderRadius:"4px",fontSize:"0.85rem"},children:g},T))})]}),e.jsx("button",{className:"btn-primary",onClick:E,style:{width:"100%"},children:v?"Update Distraction":"Save Distraction"})]}),e.jsxs("div",{style:{marginTop:"2rem"},children:[e.jsx("h3",{children:"Manage Distractions"}),e.jsxs("div",{style:{display:"grid",gap:"0.5rem"},children:[r.map(g=>e.jsxs("div",{style:{padding:"1rem",background:"var(--color-bg-secondary)",borderRadius:"var(--radius-md)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontWeight:"500"},children:g.name}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{onClick:()=>z(g),style:{background:"none",border:"none",cursor:"pointer",color:"var(--color-primary)"},children:e.jsx($e,{size:18})}),e.jsx("button",{onClick:()=>K(g.id),style:{background:"none",border:"none",cursor:"pointer",color:"#ef4444"},children:e.jsx(pe,{size:18})})]})]},g.id)),r.length===0&&e.jsx("p",{style:{color:"var(--color-text-secondary)"},children:"No distractions added yet."})]})]})]})}):t==="logging"?e.jsx(W,{children:e.jsxs("div",{className:"container",children:[e.jsxs("button",{onClick:()=>{s("initial"),N()},style:{background:"var(--color-bg-secondary)",border:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",color:"var(--color-primary)",padding:"0.5rem 1rem",borderRadius:"2rem",fontWeight:"500",marginBottom:"1rem"},children:[e.jsx(q,{size:18})," Back"]}),e.jsx("h2",{children:"Log Distraction"}),L?e.jsxs("form",{onSubmit:O,className:"card",children:[e.jsx("h3",{style:{marginTop:0},children:L.name}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("label",{children:"Why did you check it? (Select all that apply)"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",marginTop:"0.5rem"},children:L.reasons.map((g,T)=>e.jsx("button",{type:"button",onClick:()=>B(g),style:{padding:"0.5rem 1rem",borderRadius:"2rem",border:"1px solid var(--color-primary)",background:m.includes(g)?"var(--color-primary)":"white",color:m.includes(g)?"white":"var(--color-primary)",cursor:"pointer"},children:g},T))})]}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("label",{children:"Time Spent (Minutes)"}),e.jsx(ze,{value:j,onChange:U})]}),e.jsx(je,{value:_,onChange:y}),e.jsx("button",{type:"submit",className:"btn-primary",style:{width:"100%",opacity:j?1:.5,cursor:j?"pointer":"not-allowed"},disabled:!j,children:"Save Log"})]}):e.jsxs("div",{style:{display:"grid",gap:"1.5rem"},children:[e.jsx("p",{style:{textAlign:"center",color:"var(--color-text-secondary)"},children:"What's pulling your attention?"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:"1rem"},children:[r.map(g=>e.jsxs("button",{onClick:()=>I(g),style:{textAlign:"left",cursor:"pointer",border:"1px solid var(--color-bg-secondary)",background:"white",padding:"1.25rem",borderRadius:"var(--radius-lg)",boxShadow:"0 2px 4px rgba(0,0,0,0.05)",transition:"transform 0.1s, border-color 0.1s",display:"flex",alignItems:"center",justifyContent:"space-between"},onMouseEnter:T=>{T.currentTarget.style.borderColor="var(--color-primary)",T.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:T=>{T.currentTarget.style.borderColor="var(--color-bg-secondary)",T.currentTarget.style.transform="translateY(0)"},children:[e.jsx("div",{style:{fontWeight:"600",fontSize:"1.1rem",color:"var(--color-text-primary)"},children:g.name}),e.jsx(q,{size:16,style:{transform:"rotate(180deg)",color:"var(--color-text-secondary)"}})]},g.id)),e.jsxs("button",{onClick:()=>s("config"),style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",cursor:"pointer",border:"2px dashed var(--color-bg-secondary)",background:"transparent",padding:"1rem",borderRadius:"var(--radius-lg)",color:"var(--color-text-secondary)",fontWeight:"500"},children:[e.jsx(he,{size:20}),e.jsx("span",{children:"Add New"})]})]})]})]})}):e.jsx(W,{children:e.jsxs("div",{className:"container",style:{textAlign:"center",paddingTop:"2rem"},children:[e.jsx("div",{style:{position:"absolute",left:"1rem",top:"5rem"},children:e.jsxs("button",{onClick:()=>o("/"),style:{background:"var(--color-bg-secondary)",border:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",color:"var(--color-primary)",padding:"0.5rem 1rem",borderRadius:"2rem",fontWeight:"500"},children:[e.jsx(q,{size:18})," Back"]})}),e.jsx(we,{size:64,style:{color:"var(--color-text-accent)",marginBottom:"1rem"}}),e.jsx("h2",{style:{fontSize:"2rem",marginBottom:"2rem"},children:"Distracted?"}),e.jsxs("div",{style:{display:"grid",gap:"1rem",width:"100%",maxWidth:"320px",margin:"0 auto"},children:[e.jsxs("button",{className:"btn-primary",style:{padding:"1.25rem",fontSize:"1.1rem",background:"#fee2e2",color:"#b91c1c",border:"1px solid #fecaca",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.75rem",borderRadius:"var(--radius-lg)"},onClick:()=>{N(),s("logging")},children:[e.jsx(we,{size:24})," Yes, I gave in"]}),e.jsxs("button",{className:"btn-primary",style:{padding:"1.25rem",fontSize:"1.1rem",background:"#dcfce7",color:"#15803d",border:"1px solid #bbf7d0",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.75rem",borderRadius:"var(--radius-lg)"},onClick:()=>s("calm"),children:[e.jsx(ue,{size:24})," No, I'm focused"]})]}),e.jsx("div",{style:{marginTop:"2rem"},children:e.jsxs("button",{onClick:()=>s("config"),style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",background:"transparent",border:"1px dashed var(--color-text-secondary)",color:"var(--color-text-secondary)",cursor:"pointer",padding:"0.75rem 1.5rem",borderRadius:"var(--radius-full)",fontSize:"0.9rem",transition:"all 0.2s"},children:[e.jsx(he,{size:16})," Add Distraction"]})})]})})},ot=(o,t="")=>Object.keys(o).reduce((s,r)=>{const n=t.length?t+".":"";return typeof o[r]=="object"&&o[r]!==null&&!Array.isArray(o[r])?Object.assign(s,ot(o[r],n+r)):Array.isArray(o[r])?s[n+r]=o[r].join(";"):s[n+r]=o[r],s},{}),it=o=>{if(!o||o.length===0)return"";const t=o.map(n=>ot(n)),s=Array.from(new Set(t.flatMap(Object.keys)));return s.sort((n,a)=>n==="timestamp"?-1:a==="timestamp"?1:n==="event_type"?-1:a==="event_type"?1:n.localeCompare(a)),[s.join(","),...t.map(n=>s.map(a=>{let i=n[a]||"";const p=String(i);return p.includes(",")||p.includes('"')||p.includes(`
`)?`"${p.replace(/"/g,'""')}"`:p}).join(","))].join(`
`)},at=(o,t="stop-procrastinating-data.csv")=>{const s=new Blob([o],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a");if(r.download!==void 0){const n=URL.createObjectURL(s);r.setAttribute("href",n),r.setAttribute("download",t),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)}},ir=()=>{const o=G(),[t,s]=c.useState([]),[r,n]=c.useState([]);c.useEffect(()=>{const i=x(d.TASKS,[]),p=x(d.SCHEDULED_TASKS,[]),u=x(d.WORK_LOGS,[]),h=x(d.DISTRACTION_LOGS,[]),D=x(d.REFLECTIONS,[]),v={},w=m=>(v[m]||(v[m]={date:new Date(m).toISOString(),taskTime:0,distractionTime:0,pointsScored:0,workScore:0,procrastinationScore:0,tasksDoneCount:0}),v[m]);[...i,...p].forEach(m=>{if(m.completed&&m.completedAt){const f=new Date(m.completedAt).toDateString(),j=w(f);j.taskTime+=parseInt(m.timeTaken)||0,j.tasksDoneCount+=1,m.pointsEarned!==void 0?j.pointsScored+=m.pointsEarned:j.pointsScored+=10+(parseInt(m.timeTaken)||0)}}),u.forEach(m=>{if(m.date){const f=new Date(m.date).toDateString(),j=w(f),U=parseInt(m.duration)||0;j.taskTime+=U,j.pointsScored+=U,j.tasksDoneCount+=1}}),h.forEach(m=>{if(m.date){const f=new Date(m.date).toDateString(),j=w(f);j.distractionTime+=parseInt(m.duration)||0}}),D.forEach(m=>{const f=new Date(m.date).toDateString();v[f]||(v[f]={...m,date:new Date(f).toISOString()})}),Object.keys(v).forEach(m=>{const f=v[m],j=f.taskTime+f.distractionTime;j>0&&(f.procrastinationScore=Math.round(f.distractionTime/j*100),f.workScore=100-f.procrastinationScore)});const L=Object.values(v).sort((m,f)=>new Date(m.date)-new Date(f.date));s(L);const I=nt();n(I)},[]);const a=()=>{const i=x(d.EVENT_LOG,[]);if(!i||i.length===0){alert("No detailed event data found yet. Start using the app to generate logs!");return}const p=it(i);at(p,`stop_procrastinating_events_${new Date().toISOString().split("T")[0]}.csv`)};return e.jsx(W,{children:e.jsxs("div",{className:"container",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"2rem"},children:[e.jsxs("button",{onClick:()=>o("/"),style:{background:"var(--color-bg-secondary)",border:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",color:"var(--color-primary)",padding:"0.5rem 1rem",borderRadius:"2rem",fontWeight:"500",marginRight:"1rem"},children:[e.jsx(q,{size:18})," Back"]}),e.jsx("h2",{style:{flex:1,textAlign:"center",margin:0},children:"Progress Analysis"}),e.jsx("button",{onClick:a,style:{background:"transparent",border:"1px solid var(--color-primary)",color:"var(--color-primary)",padding:"0.5rem",borderRadius:"50%",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},title:"Export Detailed Event Logs (CSV)",children:e.jsx(ye,{size:20})})]}),e.jsxs("div",{style:{display:"grid",gap:"2rem"},children:[r.length>0&&e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"1rem"},children:r.map((i,p)=>e.jsxs("div",{className:"card",style:{background:i.type==="warning"?"#fef2f2":i.type==="success"?"#f0fdf4":"#f0f9ff",border:i.type==="warning"?"1px solid #fecaca":i.type==="success"?"1px solid #bbf7d0":"1px solid #bae6fd"},children:[e.jsxs("h3",{style:{marginBottom:"0.5rem",fontSize:"1rem",color:i.type==="warning"?"#b91c1c":i.type==="success"?"#15803d":"#0369a1",display:"flex",alignItems:"center",gap:"0.5rem"},children:[i.type==="warning"?e.jsx(Ae,{size:18}):i.type==="success"?e.jsx(Pe,{size:18}):e.jsx(me,{size:18}),i.title]}),e.jsx("p",{style:{color:i.type==="warning"?"#991b1b":i.type==="success"?"#166534":"#0284c7",fontSize:"0.95rem",margin:0},children:i.text.replace(/\*\*/g,"")})]},p))}),e.jsxs("div",{className:"card",style:{height:"400px",display:"flex",flexDirection:"column"},children:[e.jsx("h3",{style:{marginBottom:"1rem",color:"var(--color-text-primary)"},children:"Focus Consistency"}),e.jsx("p",{style:{fontSize:"0.9rem",color:"var(--color-text-secondary)",marginBottom:"1rem"},children:"Work Score vs Procrastination Score over time."}),e.jsx("div",{style:{flex:1,minHeight:0},children:e.jsx(ce,{width:"100%",height:"100%",children:e.jsxs(wt,{data:t,margin:{top:5,right:5,bottom:5,left:-20},children:[e.jsx(Se,{strokeDasharray:"3 3",vertical:!1,stroke:"#e2e8f0"}),e.jsx(be,{dataKey:"date",tickFormatter:i=>new Date(i).getDate()+"/"+(new Date(i).getMonth()+1),tick:{fontSize:12},stroke:"#94a3b8"}),e.jsx(ke,{tick:{fontSize:12},stroke:"#94a3b8"}),e.jsx(de,{labelFormatter:i=>new Date(i).toDateString(),contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)"}}),e.jsx(Le,{}),e.jsx(Ne,{type:"monotone",dataKey:"workScore",name:"Work Score",stroke:"#22c55e",strokeWidth:3,dot:{r:4},activeDot:{r:6}}),e.jsx(Ne,{type:"monotone",dataKey:"procrastinationScore",name:"Procrastination",stroke:"#ef4444",strokeWidth:3,dot:{r:4}})]})})})]}),e.jsxs("div",{className:"card",style:{height:"400px",display:"flex",flexDirection:"column"},children:[e.jsx("h3",{style:{marginBottom:"1rem",color:"var(--color-text-primary)"},children:"Daily Time Breakdown (Mins)"}),e.jsx("div",{style:{flex:1,minHeight:0},children:e.jsx(ce,{width:"100%",height:"100%",children:e.jsxs(Tt,{data:t,margin:{top:5,right:5,bottom:5,left:-20},children:[e.jsx(Se,{strokeDasharray:"3 3",vertical:!1,stroke:"#e2e8f0"}),e.jsx(be,{dataKey:"date",tickFormatter:i=>new Date(i).getDate()+"/"+(new Date(i).getMonth()+1),tick:{fontSize:12},stroke:"#94a3b8"}),e.jsx(ke,{tick:{fontSize:12},stroke:"#94a3b8"}),e.jsx(de,{labelFormatter:i=>new Date(i).toDateString(),cursor:{fill:"#f1f5f9"},contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)"}}),e.jsx(Le,{}),e.jsx(Oe,{dataKey:"taskTime",name:"Productive Time",stackId:"a",fill:"#22c55e",radius:[0,0,4,4]}),e.jsx(Oe,{dataKey:"distractionTime",name:"Distracted Time",stackId:"a",fill:"#f97316",radius:[4,4,0,0]})]})})})]}),e.jsxs("div",{className:"card",style:{height:"350px",display:"flex",flexDirection:"column"},children:[e.jsx("h3",{style:{marginBottom:"1rem",color:"var(--color-text-primary)"},children:"Growth (Points Earned)"}),e.jsx("div",{style:{flex:1,minHeight:0},children:e.jsx(ce,{width:"100%",height:"100%",children:e.jsxs(Dt,{data:t,margin:{top:5,right:5,bottom:5,left:-20},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorPoints",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#8b5cf6",stopOpacity:.8}),e.jsx("stop",{offset:"95%",stopColor:"#8b5cf6",stopOpacity:0})]})}),e.jsx(Se,{strokeDasharray:"3 3",vertical:!1,stroke:"#e2e8f0"}),e.jsx(be,{dataKey:"date",tickFormatter:i=>new Date(i).getDate()+"/"+(new Date(i).getMonth()+1),tick:{fontSize:12},stroke:"#94a3b8"}),e.jsx(ke,{tick:{fontSize:12},stroke:"#94a3b8"}),e.jsx(de,{labelFormatter:i=>new Date(i).toDateString(),contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)"}}),e.jsx(Ct,{type:"monotone",dataKey:"pointsScored",name:"Points",stroke:"#8b5cf6",fillOpacity:1,fill:"url(#colorPoints)"})]})})})]})]})]})})},ar=()=>{const o=G(),[t,s]=c.useState(!1),[r,n]=c.useState(null),a=async()=>{s(!0),n(null);try{const p=(await Kt($,Gt)).user,u=ve(ge,"users",p.uid);if((await Je(u)).exists())tt(),await Ze(p);else{const D={email:p.email,displayName:p.displayName,createdAt:new Date().toISOString(),tasks:JSON.stringify(x(d.TASKS,[])),scheduled:JSON.stringify(x(d.SCHEDULED_TASKS,[])),reflections:JSON.stringify(x(d.REFLECTIONS,[])),stats:JSON.stringify(x(d.USER_STATS,{})),mood:x(d.USER_MOOD,null)};await Ve(u,D),console.log("Local data backed up to cloud!")}o("/")}catch(i){console.error("Login Result Error:",i),n(`Failed to sign in: ${i.message}`)}finally{s(!1)}};return e.jsx(W,{children:e.jsx("div",{className:"container",style:{textAlign:"center",marginTop:"4rem"},children:e.jsxs("div",{className:"card",style:{maxWidth:"400px",margin:"0 auto"},children:[e.jsx("h2",{style:{marginBottom:"1rem"},children:"Backup Your Progress"}),e.jsx("p",{style:{color:"var(--color-text-secondary)",marginBottom:"2rem"},children:"Sign in to save your tasks, streaks, and reflections to the cloud. Access them from any device."}),r&&e.jsx("div",{style:{color:"var(--color-danger)",marginBottom:"1rem",fontSize:"0.9rem"},children:r}),e.jsxs("button",{onClick:a,disabled:t,className:"btn-primary",style:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",gap:"0.75rem",padding:"0.75rem"},children:[t?e.jsx(It,{className:"spin",size:20}):e.jsx(We,{size:20}),t?"Signing In...":"Sign in with Google"]})]})})})},lr=()=>{const[o,t]=c.useState("idle");return c.useEffect(()=>{let s;const r=()=>{t("syncing"),clearTimeout(s)},n=()=>{t("success"),s=setTimeout(()=>{t("idle")},3e3)},a=()=>{t("error")};return window.addEventListener("sp-sync-start",r),window.addEventListener("sp-sync-success",n),window.addEventListener("sp-sync-error",a),()=>{window.removeEventListener("sp-sync-start",r),window.removeEventListener("sp-sync-success",n),window.removeEventListener("sp-sync-error",a),clearTimeout(s)}},[]),e.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",padding:"0.25rem 0.75rem",borderRadius:"2rem",fontSize:"0.85rem",fontWeight:"500",transition:"all 0.3s ease",...cr(o)},children:[dr(o),e.jsx("span",{children:mr(o)})]})},cr=o=>{switch(o){case"syncing":return{background:"#ebf8ff",color:"#0369a1"};case"success":return{background:"#f0fdf4",color:"#166534"};case"error":return{background:"#fef2f2",color:"#991b1b"};default:return{}}},dr=o=>{switch(o){case"syncing":return e.jsx(qe,{size:14,className:"spin"});case"success":return e.jsx(Et,{size:14});case"error":return e.jsx(Ee,{size:14});default:return e.jsx(At,{size:14})}},mr=o=>{switch(o){case"syncing":return"Syncing...";case"success":return"Saved";case"error":return"Sync Failed";default:return"Sync Ready"}},pr=()=>{const o=G(),{theme:t,toggleTheme:s}=st(),r=$.currentUser,[n,a]=c.useState(0),i=()=>{const D=x(d.EVENT_LOG,[]);if(!D||D.length===0){alert("No data to export yet.");return}const v=it(D);at(v,`stop_procrastinating_backup_${new Date().toISOString().split("T")[0]}.csv`)},p=()=>{window.confirm("ARE YOU SURE? This will delete ALL your logs, streaks, and local data. This action cannot be undone.")&&(tt(),window.location.reload())},u=()=>{Mt($).then(()=>{o("/"),window.location.reload()})},h=async()=>{await $t()};return e.jsx(W,{children:e.jsxs("div",{className:"container",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"2rem"},children:[e.jsxs("button",{onClick:()=>o(-1),className:"btn-secondary",style:{display:"flex",alignItems:"center",gap:"0.5rem",marginRight:"1rem"},children:[e.jsx(q,{size:18})," Back"]}),e.jsx("h2",{style:{margin:0},children:"Settings"}),e.jsx("div",{style:{marginLeft:"auto"},children:e.jsx(lr,{})})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[e.jsxs("div",{className:"card",children:[e.jsxs("h3",{style:{marginTop:0,marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[t==="light"?e.jsx(Ce,{size:20}):e.jsx(De,{size:20})," Appearance"]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"App Theme"}),e.jsx("button",{onClick:s,className:"btn-secondary",style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:t==="light"?"Switch to Dark Mode":"Switch to Light Mode"})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("h3",{style:{marginTop:0,marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(ye,{size:20})," Data Management"]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsxs("button",{onClick:h,className:"btn-secondary",style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",width:"100%"},children:[e.jsx(qe,{size:18})," Sync Now"]}),e.jsxs("button",{onClick:i,className:"btn-secondary",style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",width:"100%"},children:[e.jsx(ye,{size:18})," Export Data (CSV)"]}),e.jsx("div",{style:{borderTop:"1px solid var(--border-color)",margin:"0.5rem 0"}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("strong",{style:{color:"var(--color-danger)"},children:"Danger Zone"}),e.jsx("p",{style:{fontSize:"0.85rem",color:"var(--color-text-secondary)",margin:0},children:"Irreversible data loss."})]}),e.jsxs("button",{onClick:p,style:{background:"#fee2e2",color:"#b91c1c",border:"1px solid #fca5a5",padding:"0.5rem 1rem",borderRadius:"var(--radius-md)",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.9rem",fontWeight:"500"},children:[e.jsx(pe,{size:16})," Clear All Data"]})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("h3",{style:{marginTop:0,marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Be,{size:20})," Account"]}),r?e.jsxs("div",{style:{textAlign:"center"},children:[r.photoURL&&e.jsx("img",{src:r.photoURL,alt:"Profile",style:{width:"64px",height:"64px",borderRadius:"50%",marginBottom:"0.5rem"}}),e.jsx("div",{style:{fontWeight:"bold",fontSize:"1.1rem"},children:r.displayName||"User"}),e.jsx("div",{style:{color:"var(--color-text-secondary)",marginBottom:"1.5rem"},children:r.email}),e.jsxs("button",{onClick:u,className:"btn-secondary",style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem"},children:[e.jsx(zt,{size:18})," Sign Out"]})]}):e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("p",{children:"You are using a local guest account."}),e.jsx("button",{onClick:()=>o("/signin"),className:"btn-primary",style:{width:"100%"},children:"Sign In with Google"})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("h3",{style:{marginTop:0,marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(_e,{size:20})," Feedback"]}),e.jsx("p",{style:{color:"var(--color-text-secondary)",fontSize:"0.9rem",marginBottom:"1rem"},children:"Help us improve! Share your experience, report bugs, or suggest new features."}),e.jsxs("a",{href:"https://forms.gle/fh9NiUWpYispsEka6",target:"_blank",rel:"noopener noreferrer",className:"btn-primary",style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",textDecoration:"none",width:"100%"},children:[e.jsx(_e,{size:18})," Send Feedback / Suggestions"]})]}),e.jsxs("div",{style:{textAlign:"center",color:"var(--color-text-secondary)",fontSize:"0.9rem",marginTop:"1rem",cursor:"default"},onClick:()=>a(D=>D+1),children:[e.jsx("p",{children:"Stop Procrastinating v1.0.2"}),e.jsx("p",{children:"Build healthy habits, one day at a time."}),n>5&&e.jsx("p",{children:"ü¶Ñ You found a unicorn!"})]})]})]})})};function ur(){return c.useEffect(()=>{const o=$.onAuthStateChanged(t=>{t&&Ze(t)});return()=>o()},[]),e.jsx(Rt,{children:e.jsxs(Lt,{children:[e.jsx(H,{path:"/",element:e.jsx(Vt,{})}),e.jsx(H,{path:"/analysis",element:e.jsx(ir,{})}),e.jsx(H,{path:"/settings",element:e.jsx(pr,{})}),e.jsx(H,{path:"/signin",element:e.jsx(ar,{})}),e.jsx(H,{path:"/mood",element:e.jsx(Qt,{})}),e.jsx(H,{path:"/tasks",element:e.jsx(er,{})}),e.jsx(H,{path:"/add-task",element:e.jsx(tr,{})}),e.jsx(H,{path:"/complete/:taskId",element:e.jsx(rr,{})}),e.jsx(H,{path:"/schedule",element:e.jsx(sr,{})}),e.jsx(H,{path:"/reflect",element:e.jsx(nr,{})}),e.jsx(H,{path:"/limit",element:e.jsx(or,{})})]})})}Nt.createRoot(document.getElementById("root")).render(e.jsx(c.StrictMode,{children:e.jsx(Yt,{children:e.jsx(ur,{})})}));
